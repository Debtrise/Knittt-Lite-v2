"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1169],{1169:(e,t,s)=>{s.d(t,{A:()=>R});var a=s(95155),n=s(12115),o=s(48173),r=s.n(o),c=s(5565),l=s(76046),i=s(73746),d=s(26062),u=s(92823),g=s(17426),m=s(43831),h=s(69323),p=s(87694),x=s(14081),f=s(4430),b=s(68236),y=s(40767),v=s(1466),w=s(65236),j=s(86710);let N=(0,s(99827).v)((e,t)=>({notifications:[],unreadCount:0,isMinimized:!0,addNotification:s=>{let a=Date.now().toString()+Math.random().toString(36).substr(2,9),n={...s,id:a,timestamp:new Date,read:!1};e(e=>({notifications:[n,...e.notifications],unreadCount:e.unreadCount+1})),("success"===s.type||"info"===s.type)&&setTimeout(()=>{t().notifications.find(e=>e.id===a)&&t().removeNotification(a)},1e4)},markAsRead:t=>{e(e=>({notifications:e.notifications.map(e=>e.id===t?{...e,read:!0}:e),unreadCount:Math.max(0,e.unreadCount-1)}))},markAllAsRead:()=>{e(e=>({notifications:e.notifications.map(e=>({...e,read:!0})),unreadCount:0}))},removeNotification:t=>{e(e=>{let s=e.notifications.find(e=>e.id===t),a=s&&!s.read;return{notifications:e.notifications.filter(e=>e.id!==t),unreadCount:a?Math.max(0,e.unreadCount-1):e.unreadCount}})},clearAll:()=>{e({notifications:[],unreadCount:0})},toggleMinimized:()=>{e(e=>({isMinimized:!e.isMinimized}))}})),k=e=>{let{addNotification:t}=N.getState(),s="".concat(e.leadCount," New Lead").concat(e.leadCount>1?"s":""," Received"),a=e.message||"".concat(e.leadCount," lead").concat(e.leadCount>1?"s":""," created from ").concat(e.webhookName);if(e.brand||e.source){let t=[e.brand,e.source].filter(Boolean).join(" • ");a+=" (".concat(t,")")}t({type:"success",title:s,message:a,actionUrl:"/leads",actionLabel:"View Leads",webhookName:e.webhookName,leadCount:e.leadCount,leadIds:e.leadIds,brand:e.brand,source:e.source,executionDetails:e.executionDetails})},C=(e,t)=>{let{addNotification:s}=N.getState();s({type:"error",title:"Webhook Processing Failed",message:"".concat(e,": ").concat(t),actionUrl:"/webhooks",actionLabel:"Manage Webhooks",webhookName:e})};var A=s(73239),I=s(61594),S=s(23950),E=s(48617),L=s(35288),T=s(91902);let P=()=>{let{notifications:e,unreadCount:t,isMinimized:s,markAsRead:n,removeNotification:o,clearAll:c,toggleMinimized:l}=N(),i=e=>{switch(e){case"success":return(0,a.jsx)(A.A,{className:"h-5 w-5 text-green-500"});case"error":return(0,a.jsx)(I.A,{className:"h-5 w-5 text-red-500"});case"warning":return(0,a.jsx)(S.A,{className:"h-5 w-5 text-yellow-500"});case"info":return(0,a.jsx)(E.A,{className:"h-5 w-5 text-blue-500"});default:return(0,a.jsx)(L.A,{className:"h-5 w-5 text-gray-500"})}},d=e=>{switch(e){case"success":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"info":return"bg-blue-50 border-blue-200 text-blue-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}},u=e=>{if(!e.executionDetails)return null;let t=e.executionDetails,s=[];return t.conditionSets&&t.conditionSets.length>0&&s.push("Rules: ".concat(t.conditionSets.join(", "))),t.journeyEnrollments>0&&s.push("".concat(t.journeyEnrollments," Journey").concat(t.journeyEnrollments>1?"s":"")),t.actionsExecuted>0&&s.push("".concat(t.actionsExecuted," Action").concat(t.actionsExecuted>1?"s":"")),t.processingTime&&s.push("".concat(t.processingTime,"ms")),s.length>0?s.join(" • "):null};return s?(0,a.jsx)("div",{className:"fixed top-4 right-4 z-50",children:(0,a.jsxs)("button",{onClick:l,className:"relative bg-white border border-gray-200 rounded-full p-3 shadow-lg hover:shadow-xl transition-shadow duration-200",children:[(0,a.jsx)(L.A,{className:"h-6 w-6 text-gray-600"}),t>0&&(0,a.jsx)("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold rounded-full h-6 w-6 flex items-center justify-center",children:t>99?"99+":t})]})}):(0,a.jsx)("div",{className:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-200 shadow-md",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between py-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(L.A,{className:"h-5 w-5 text-gray-600"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["Notifications ",t>0&&"(".concat(t," new)")]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[e.length>0&&(0,a.jsx)("button",{onClick:c,className:"text-sm text-gray-500 hover:text-gray-700 transition-colors",children:"Clear All"}),(0,a.jsx)("button",{onClick:l,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:(0,a.jsx)(T.A,{className:"h-4 w-4"})})]})]}),0===e.length?(0,a.jsxs)("div",{className:"py-8 text-center",children:[(0,a.jsx)(L.A,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No notifications"})]}):(0,a.jsxs)("div",{className:"max-h-96 overflow-y-auto pb-4",children:[(0,a.jsx)("div",{className:"space-y-3",children:e.slice(0,10).map(e=>(0,a.jsx)("div",{className:"p-4 rounded-lg border ".concat(d(e.type)," ").concat(e.read?"":"ring-2 ring-opacity-50"),children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3 flex-1",children:[i(e.type),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-sm opacity-90 mb-2",children:e.message}),e.webhookName&&(0,a.jsxs)("div",{className:"text-xs opacity-75 space-y-1",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Webhook:"})," ",e.webhookName,e.brand&&" • ".concat(e.brand),e.source&&" • ".concat(e.source)]}),e.leadCount&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Leads:"})," ",e.leadCount," created",e.leadIds&&e.leadIds.length>0&&(0,a.jsxs)("span",{className:"ml-2 text-xs bg-white bg-opacity-50 px-2 py-1 rounded",children:["IDs: ",e.leadIds.slice(0,3).join(", "),e.leadIds.length>3&&"..."]})]}),u(e)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Execution:"})," ",u(e)]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,a.jsx)("span",{className:"text-xs opacity-75",children:e.timestamp.toLocaleTimeString()}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[e.actionUrl&&e.actionLabel&&(0,a.jsx)(r(),{href:e.actionUrl,className:"text-xs bg-white bg-opacity-50 hover:bg-opacity-75 px-3 py-1 rounded transition-colors",children:e.actionLabel}),!e.read&&(0,a.jsx)("button",{onClick:()=>n(e.id),className:"text-xs bg-white bg-opacity-50 hover:bg-opacity-75 px-2 py-1 rounded transition-colors",children:"Mark Read"})]})]})]})]}),(0,a.jsx)("button",{onClick:()=>o(e.id),className:"text-gray-400 hover:text-gray-600 transition-colors ml-2",children:(0,a.jsx)(y.A,{className:"h-4 w-4"})})]})},e.id))}),e.length>10&&(0,a.jsx)("div",{className:"text-center mt-4",children:(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Showing 10 of ",e.length," notifications"]})})]})]})})};var M=s(34639);class D{start(){this.isPolling||(this.isPolling=!0,this.lastCheckedTimestamp=new Date,this.checkForNewEvents(),this.pollingInterval=setInterval(()=>{this.checkForNewEvents()},this.pollingIntervalMs),console.log("\uD83D\uDD14 Enhanced webhook notification service started"))}stop(){this.isPolling&&(this.isPolling=!1,this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null),console.log("\uD83D\uDD14 Enhanced webhook notification service stopped"))}async checkForNewEvents(){try{for(let e of(await this.loadWebhooks(),await this.getRecentWebhookEvents()))await this.processWebhookEvent(e);this.lastCheckedTimestamp=new Date}catch(e){console.error("Error checking for webhook events:",e)}}async loadWebhooks(){try{let e=await M.Ay.webhooks.list({page:1,limit:100}),t=e.data||e,s=t.webhooks||t||[];for(let e of(this.webhookCache.clear(),s))this.webhookCache.set(e.id,e)}catch(e){console.error("Error loading webhooks:",e)}}async getRecentWebhookEvents(){try{let e=[];for(let[t]of this.webhookCache)try{let s=await M.Ay.webhooks.getEvents(t.toString(),{page:1,limit:10}),a=s.data||s,n=a.events||a||[];e.push(...n)}catch(e){console.error("Error getting events for webhook ".concat(t,":"),e)}return e.filter(e=>{let t=new Date(e.receivedAt);return!this.lastCheckedTimestamp||t>this.lastCheckedTimestamp}).sort((e,t)=>new Date(t.receivedAt).getTime()-new Date(e.receivedAt).getTime())}catch(e){return console.error("Error getting recent webhook events:",e),[]}}async processWebhookEvent(e){let t=this.webhookCache.get(e.webhookId);t&&(e.conditionalRulesApplied&&e.executionLog?await this.processConditionalWebhookEvent(e,t):await this.processBasicWebhookEvent(e,t))}async processConditionalWebhookEvent(e,t){let s=e.executionLog;s.actionsExecuted.filter(e=>"create_lead"===e.type&&"success"===e.status);let a=s.actionsExecuted.filter(e=>"enroll_journey"===e.type&&"success"===e.status);if(s.actionsExecuted.filter(e=>"send_notification"===e.type&&"success"===e.status),"success"===e.status&&e.createdLeadIds.length>0){let n=s.conditionResults.filter(e=>e.matched).map(e=>e.conditionSetName);k({webhookName:t.name,leadCount:e.createdLeadIds.length,leadIds:e.createdLeadIds,brand:t.brand,source:t.source,message:this.buildEnhancedMessage(t,e,{conditionSets:n,actionsExecuted:s.actionsExecuted.length,journeyEnrollments:a.length,processingTime:s.totalExecutionTime})})}else if("failed"===e.status){let a=s.actionsExecuted.filter(e=>"failed"===e.status),n=a.length>0?"Failed actions: ".concat(a.map(e=>e.type).join(", ")):e.errorMessage||"Unknown error occurred";C(t.name,n)}}async processBasicWebhookEvent(e,t){if("success"===e.status&&e.createdLeadIds.length>0)k({webhookName:t.name,leadCount:e.createdLeadIds.length,leadIds:e.createdLeadIds,brand:t.brand,source:t.source});else if("partial_success"===e.status&&e.createdLeadIds.length>0)k({webhookName:t.name,leadCount:e.createdLeadIds.length,leadIds:e.createdLeadIds,brand:t.brand,source:t.source});else if("failed"===e.status){let s=e.errorMessage||"Unknown error occurred";C(t.name,s)}}buildEnhancedMessage(e,t,s){let a="".concat(s.conditionSets.length>0?"Conditional rules triggered":"New leads received");return s.conditionSets.length>0&&(a+=" (".concat(s.conditionSets.join(", "),")")),s.journeyEnrollments>0&&(a+=" • ".concat(s.journeyEnrollments," journey").concat(s.journeyEnrollments>1?"s":""," enrolled")),s.actionsExecuted>0&&(a+=" • ".concat(s.actionsExecuted," action").concat(s.actionsExecuted>1?"s":""," executed")),a}constructor(){this.lastCheckedTimestamp=null,this.isPolling=!1,this.pollingInterval=null,this.pollingIntervalMs=3e4,this.webhookCache=new Map}}let U=new D;setTimeout(()=>{U.start()},2e3);let R=e=>{let{children:t}=e,s=(0,l.usePathname)(),{user:o,logout:N}=(0,i.n)(),[k,C]=(0,n.useState)(!1),A=[{name:"Dashboard",href:"/dashboard",icon:(0,a.jsx)(d.A,{className:"w-6 h-6"})},{name:"Leads",href:"/leads",icon:(0,a.jsx)(u.A,{className:"w-6 h-6"})},{name:"Journeys",href:"/journeys",icon:(0,a.jsx)(g.A,{className:"w-6 h-6"})},{name:"Calls",href:"/calls",icon:(0,a.jsx)(m.A,{className:"w-6 h-6"})},{name:"DIDs",href:"/dids",icon:(0,a.jsx)(h.A,{className:"w-6 h-6"})},{name:"Transfer Groups",href:"/settings/transfer-groups",icon:(0,a.jsx)(p.A,{className:"w-6 h-6"})},{name:"Templates",href:"/templates",icon:(0,a.jsx)(x.A,{className:"w-6 h-6"})},{name:"Webhooks",href:"/webhooks",icon:(0,a.jsx)(f.A,{className:"w-6 h-6"})},{name:"Reports",href:"/reports",icon:(0,a.jsx)(x.A,{className:"w-6 h-6"})},{name:"Settings",href:"/settings",icon:(0,a.jsx)(b.A,{className:"w-6 h-6"}),adminOnly:!0},{name:"Users",href:"/settings/users",icon:(0,a.jsx)(u.A,{className:"w-6 h-6"}),adminOnly:!0}],I=(null==o?void 0:o.role)==="admin"?A:A.filter(e=>!e.adminOnly),S=()=>{N(),window.location.href="/login"};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(P,{}),(0,a.jsx)("div",{className:"lg:hidden",children:(0,a.jsxs)("div",{className:"fixed inset-0 z-40 flex",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 ".concat(k?"opacity-100":"opacity-0 pointer-events-none"),onClick:()=>C(!1)}),(0,a.jsxs)("div",{className:"relative flex-1 flex flex-col max-w-xs w-full sidebar-brand ".concat(k?"translate-x-0":"-translate-x-full"),children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:(0,a.jsx)("button",{className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:()=>C(!1),children:(0,a.jsx)(y.A,{className:"h-6 w-6 text-white"})})}),(0,a.jsxs)("div",{className:"flex-1 h-0 pt-5 pb-4 overflow-y-auto",children:[(0,a.jsx)("div",{className:"flex-shrink-0 flex items-center justify-center px-4",children:(0,a.jsx)("div",{className:"h-10 w-auto relative",children:(0,a.jsx)(c.default,{src:"/logo.png",alt:"Knitt Logo",width:120,height:40,className:"w-auto h-10"})})}),(0,a.jsx)("nav",{className:"mt-5 px-2 space-y-3",children:I.map(e=>(0,a.jsxs)(r(),{href:e.href,className:"group flex items-center px-4 py-4 text-lg font-bold rounded-md ".concat(s===e.href?"bg-brand text-white":"text-gray-300 hover:bg-brand hover:bg-opacity-80 hover:text-white"),children:[e.icon,(0,a.jsx)("span",{className:"ml-4",children:e.name})]},e.name))})]}),(0,a.jsx)("div",{className:"flex-shrink-0 flex border-t border-gray-700 p-4",children:(0,a.jsxs)("div",{className:"flex-shrink-0 group block",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{children:(0,a.jsx)(v.A,{className:"inline-block h-10 w-10 rounded-full text-gray-300 bg-gray-600 p-2"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-base font-medium text-white",children:null==o?void 0:o.username}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-300",children:null==o?void 0:o.role})]})]}),(0,a.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,a.jsxs)(r(),{href:"/settings/profile",className:"flex items-center text-sm font-medium text-gray-300 hover:text-white",children:[(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Profile"]}),(0,a.jsxs)("button",{onClick:S,className:"flex items-center text-sm font-medium text-brand hover:text-white",children:[(0,a.jsx)(w.A,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]})})]})]})}),(0,a.jsx)("div",{className:"hidden lg:flex lg:w-64 lg:flex-col lg:fixed lg:inset-y-0",children:(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-h-0 sidebar-brand",children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto",children:[(0,a.jsx)("div",{className:"flex items-center justify-center flex-shrink-0 px-4",children:(0,a.jsx)("div",{className:"h-12 w-auto relative",children:(0,a.jsx)(c.default,{src:"/logo.png",alt:"Knitt Logo",width:150,height:50,className:"w-auto h-12"})})}),(0,a.jsx)("nav",{className:"mt-8 flex-1 px-2 space-y-3",children:I.map(e=>(0,a.jsxs)(r(),{href:e.href,className:"group flex items-center px-4 py-4 text-lg font-bold rounded-md ".concat(s===e.href?"bg-brand text-white":"text-gray-300 hover:bg-brand hover:bg-opacity-80 hover:text-white"),children:[e.icon,(0,a.jsx)("span",{className:"ml-4",children:e.name})]},e.name))})]}),(0,a.jsx)("div",{className:"flex-shrink-0 flex border-t border-gray-700 p-4",children:(0,a.jsxs)("div",{className:"flex-shrink-0 group block",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{children:(0,a.jsx)(v.A,{className:"inline-block h-10 w-10 rounded-full text-gray-300 bg-gray-600 p-2"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-base font-medium text-white",children:null==o?void 0:o.username}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-300",children:null==o?void 0:o.role})]})]}),(0,a.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,a.jsxs)(r(),{href:"/settings/profile",className:"flex items-center text-sm font-medium text-gray-300 hover:text-white",children:[(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Profile"]}),(0,a.jsxs)("button",{onClick:S,className:"flex items-center text-sm font-medium text-brand hover:text-white",children:[(0,a.jsx)(w.A,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]})})]})}),(0,a.jsxs)("div",{className:"lg:pl-64 flex flex-col flex-1",children:[(0,a.jsx)("div",{className:"sticky top-0 z-10 lg:hidden pl-1 pt-1 sm:pl-3 sm:pt-3 bg-brand",children:(0,a.jsxs)("button",{type:"button",className:"-ml-0.5 -mt-0.5 h-12 w-12 inline-flex items-center justify-center rounded-md text-white hover:text-gray-200 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:()=>C(!0),children:[(0,a.jsx)("span",{className:"sr-only",children:"Open sidebar"}),(0,a.jsx)(j.A,{className:"h-6 w-6"})]})}),(0,a.jsx)("main",{className:"flex-1 pb-10",children:(0,a.jsx)("div",{className:"py-6",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8",children:t})})})]})]})}},34639:(e,t,s)=>{s.d(t,{Ay:()=>p,Rk:()=>m,bS:()=>h,wo:()=>g});var a=s(82651),n=s(73746),o=s(2818);let r=o.env.NEXT_PUBLIC_API_URL||"http://34.122.156.88:3001/api",c=o.env.NEXT_PUBLIC_SMS_API_URL||"http://34.122.156.88:3100",l=a.A.create({baseURL:r,timeout:15e3,headers:{"Content-Type":"application/json"}}),i=a.A.create({baseURL:"/api",timeout:15e3,headers:{"Content-Type":"application/json"}}),d=a.A.create({baseURL:c,timeout:3e4,maxContentLength:0xa00000,maxBodyLength:0xa00000,headers:{"Content-Type":"application/json"}}),u=e=>{let t=n.n.getState().token,s=n.n.getState().user;if(t&&(e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(t)),(null==s?void 0:s.tenantId)&&(e.headers=e.headers||{},e.headers["X-Tenant-ID"]=s.tenantId,e.url&&(e.url.includes("freepbx")||e.url.includes("upload-to-freepbx")))){let t=e.url.includes("?")?"&":"?";e.url+="".concat(t,"tenantId=").concat(s.tenantId)}return e};l.interceptors.request.use(u),i.interceptors.request.use(u),d.interceptors.request.use(u),l.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(n.n.getState().logout(),window.location.href="/login"),Promise.reject(e)}),i.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(n.n.getState().logout(),window.location.href="/login"),Promise.reject(e)});let g={list:e=>l.get("/transfer-groups",{params:e}),get:e=>l.get("/transfer-groups/".concat(e)),create:e=>l.post("/transfer-groups",e),update:(e,t)=>l.put("/transfer-groups/".concat(e),t),delete:e=>l.delete("/transfer-groups/".concat(e)),addNumber:(e,t)=>l.post("/transfer-groups/".concat(e,"/numbers"),t),updateNumber:(e,t,s)=>l.put("/transfer-groups/".concat(e,"/numbers/").concat(t),s),removeNumber:(e,t)=>l.delete("/transfer-groups/".concat(e,"/numbers/").concat(t)),getNextNumber:e=>l.get("/transfer-groups/".concat(e,"/next-number"))},m={getConfig:()=>l.get("/elevenlabs/config"),configure:e=>l.post("/elevenlabs/config",e),getVoices:()=>l.get("/elevenlabs/voices"),getUsage:()=>l.get("/elevenlabs/usage"),list:e=>l.get("/recordings",{params:e}),get:e=>l.get("/recordings/".concat(e)),create:e=>l.post("/recordings",e),update:(e,t)=>l.put("/recordings/".concat(e),t),delete:e=>l.delete("/recordings/".concat(e)),generateAudio:e=>l.post("/recordings/".concat(e,"/generate")),uploadAudio:e=>{let t=n.n.getState().user;return(null==t?void 0:t.tenantId)&&e.append("tenantId",t.tenantId),l.post("/recordings/upload",e,{headers:{"Content-Type":"multipart/form-data"}})},stream:e=>l.get("/recordings/".concat(e,"/stream"),{responseType:"blob",headers:{Accept:"audio/*"}}),getMetadata:e=>l.get("/recordings/".concat(e,"/metadata")),preview:e=>l.post("/recordings/preview",e),streamPreview:e=>l.get("/recordings/preview/".concat(e,"/stream"),{responseType:"blob",headers:{Accept:"audio/*"}}),batchPreview:e=>l.post("/recordings/preview/batch",e),getVoicePresets:()=>l.get("/recordings/voice-presets"),getAnalytics:(e,t)=>l.get("/recordings/".concat(e,"/analytics"),{params:t}),getUsageHistory:(e,t)=>l.get("/recordings/".concat(e,"/usage"),{params:t}),trackUsage:(e,t)=>l.post("/recordings/".concat(e,"/track-usage"),t)},h={test:e=>{let t=n.n.getState().user;return l.post("/recordings/test-freepbx",{...e,tenantId:(null==t?void 0:t.tenantId)||"1"})},syncRecording:async e=>{try{let t=n.n.getState().user,s=(null==t?void 0:t.tenantId)||"1";return await l.post("/recordings/".concat(e,"/sync-freepbx?tenantId=").concat(s),{tenantId:s})}catch(e){throw console.error("FreePBX sync error:",e),e}},uploadRecording:async e=>{try{let t=n.n.getState().user,s=(null==t?void 0:t.tenantId)||"1";return await l.post("/recordings/".concat(e,"/upload-to-freepbx?tenantId=").concat(s),{tenantId:s})}catch(e){var t,s,a,o;if((null===(t=e.response)||void 0===t?void 0:t.status)===404)throw Error("FreePBX upload functionality is not yet implemented on the backend. Please contact your system administrator.");if(null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:null===(s=a.error)||void 0===s?void 0:s.includes("Upload failed"))throw Error("FreePBX upload failed. Please check your FreePBX server connection and credentials.");throw e}}},p={auth:{login:(e,t)=>l.post("/login",{username:e,password:t}),register:e=>l.post("/register",e)},users:{list:e=>l.get("/users",{params:e}),get:e=>l.get("/users/".concat(e)),create:e=>{let t=n.n.getState().user;return l.post("/register",{...e,tenantId:(null==t?void 0:t.tenantId)||"1",role:e.role||"agent"})},update:(e,t)=>l.put("/users/".concat(e),t),delete:e=>l.delete("/users/".concat(e)),changePassword:e=>l.post("/users/change-password",e),me:()=>{let e=n.n.getState().user;return(null==e?void 0:e.userId)?l.get("/users/".concat(e.userId)):l.get("/users/me")}},tenants:{create:e=>l.post("/tenants",e),get:e=>l.get("/tenants/".concat(e)),update:(e,t)=>l.put("/tenants/".concat(e),t)},leads:{upload:(e,t)=>l.post("/leads/upload",{fileContent:e,options:t}),list:async e=>(await l.get("/leads",{params:e})).data,get:e=>l.get("/leads/".concat(e)),create:e=>l.post("/leads",e),update:(e,t)=>l.put("/leads/".concat(e),t),delete:e=>l.delete("/leads/".concat(e)),bulkDelete:e=>l.post("/leads/delete",{ids:e})},calls:{make:e=>l.post("/make-call",e),updateStatus:(e,t)=>l.put("/calls/".concat(e,"/status"),{status:t}),get:e=>l.get("/calls/".concat(e)),list:e=>l.get("/calls",{params:e})},dids:{list:e=>l.get("/dids",{params:e}),get:e=>l.get("/dids/".concat(e)),create:e=>l.post("/dids",e),update:(e,t)=>l.put("/dids/".concat(e),t),delete:e=>l.delete("/dids/".concat(e)),bulkDelete:e=>l.post("/dids/bulk-delete",{ids:e}),bulkUpload:e=>l.post("/dids/bulk-upload",{fileContent:e})},journeys:{list:e=>l.get("/journeys",{params:e}),get:e=>l.get("/journeys/".concat(e)),create:e=>l.post("/journeys",e),update:(e,t)=>l.put("/journeys/".concat(e),t),delete:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return l.delete("/journeys/".concat(e,"?force=").concat(t))},listSteps:e=>l.get("/journeys/".concat(e,"/steps")),createStep:(e,t)=>l.post("/journeys/".concat(e,"/steps"),t),updateStep:(e,t,s)=>l.put("/journeys/".concat(e,"/steps/").concat(t),s),deleteStep:function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return l.delete("/journeys/".concat(e,"/steps/").concat(t,"?force=").concat(s))},getLeads:(e,t)=>l.get("/journeys/".concat(e,"/leads"),{params:t}),enrollLeads:(e,t)=>l.post("/journeys/".concat(e,"/enroll"),t),enrollLeadsByCriteria:(e,t)=>l.post("/journeys/".concat(e,"/enroll-by-criteria"),t),getLeadJourneys:e=>l.get("/leads/".concat(e,"/journeys")),updateLeadJourneyStatus:(e,t,s)=>l.put("/leads/".concat(e,"/journeys/").concat(t,"/status"),s),executeStep:(e,t,s)=>l.post("/leads/".concat(e,"/journeys/").concat(t,"/execute"),s),getMatchingStats:e=>l.get("/journeys/".concat(e,"/matching-stats")),getStatistics:()=>l.get("/journeys/stats"),getStatsByBrand:()=>l.get("/stats/journeys/by-brand"),getStatsBySource:()=>l.get("/stats/journeys/by-source"),getUpcomingExecutions:e=>l.get("/executions/upcoming",{params:e})},webhooks:{list:e=>l.get("/webhooks",{params:e}),get:e=>l.get("/webhooks/".concat(e)),create:e=>l.post("/webhooks",e),update:(e,t)=>l.put("/webhooks/".concat(e),t),delete:e=>l.delete("/webhooks/".concat(e)),getEvents:(e,t)=>l.get("/webhooks/".concat(e,"/events"),{params:t}),test:(e,t)=>l.post("/webhooks/".concat(e,"/test"),t),regenerateKey:e=>l.post("/webhooks/".concat(e,"/regenerate-key")),regenerateToken:e=>l.post("/webhooks/".concat(e,"/regenerate-token")),health:e=>l.get("/webhook-health/".concat(e)),capabilities:()=>l.get("/system/webhook-capabilities")},sms:{getConfig:()=>l.get("/twilio/config"),saveConfig:e=>l.post("/twilio/config",e),testConnection:()=>l.post("/twilio/test"),listNumbers:()=>l.get("/twilio/numbers"),syncNumbers:()=>l.post("/twilio/numbers/sync"),send:e=>l.post("/sms/send",e),sendTemplate:e=>l.post("/sms/send-template",e),sendBulk:e=>l.post("/sms/send-bulk",e),getConversation:(e,t)=>l.get("/sms/conversation/".concat(e),{params:t}),listConversations:e=>l.get("/sms/conversations",{params:e}),getMessages:e=>l.get("/sms/messages",{params:e}),getMessage:e=>l.get("/sms/messages/".concat(e))},templates:{list:e=>l.get("/templates",{params:e}),get:e=>l.get("/templates/".concat(e)),create:e=>l.post("/templates",e),update:(e,t)=>l.put("/templates/".concat(e),t),delete:e=>l.delete("/templates/".concat(e)),listCategories:e=>l.get("/templates/categories",{params:{type:e}}),createCategory:e=>l.post("/templates/categories",e),updateCategory:(e,t)=>l.put("/templates/categories/".concat(e),t),deleteCategory:e=>l.delete("/templates/categories/".concat(e)),renderPreview:(e,t)=>l.post("/templates/".concat(e,"/render"),t)},transferGroups:g,email:{getConfig:()=>l.get("/email/config"),saveConfig:e=>l.post("/email/config",e),test:e=>l.post("/email/test",{to:e}),send:e=>l.post("/email/send",e)},reports:{generateCallSummary:e=>l.post("/reports/call-summary",e),generateSmsSummary:e=>l.post("/reports/sms-summary",e),generateAgentPerformance:e=>l.post("/reports/agent-performance",e),generateLeadConversion:e=>l.post("/reports/lead-conversion",e),generateJourneyAnalytics:e=>l.post("/reports/journey-analytics",e),generateCustom:e=>l.post("/reports/custom",e),export:e=>l.post("/reports/export",e)},reportTemplates:{list:()=>l.get("/report-templates"),get:e=>l.get("/report-templates/".concat(e)),create:e=>l.post("/report-templates",e),update:(e,t)=>l.put("/report-templates/".concat(e),t),delete:e=>l.delete("/report-templates/".concat(e)),execute:(e,t)=>l.post("/report-templates/".concat(e,"/execute"),t),schedule:(e,t)=>l.post("/report-templates/".concat(e,"/schedule"),t)},dashboard:{getStats:()=>l.get("/dashboard/stats"),getHistory:e=>l.get("/dashboard/history",{params:{hours:e}}),getTodayStats:()=>l.get("/stats/today"),getHourlyBreakdown:()=>l.get("/stats/hourly")},system:{getAgentStatus:e=>{let t={url:e.url,user:e.user,pass:e.pass,ingroups:e.ingroup};return l.get("/agent-status",{params:t})},getDailyReport:e=>l.get("/reports/daily",{params:{date:e}}),getModuleStatus:()=>l.get("/system/module-status"),getDialplanCapabilities:()=>l.get("/system/dialplan-capabilities")},recordings:m,freepbx:h}},73746:(e,t,s)=>{s.d(t,{n:()=>o});var a=s(99827),n=s(60709);let o=(0,a.v)()((0,n.Zr)(e=>({token:null,user:null,isAuthenticated:!1,setAuth:(t,s)=>{e({token:t,user:s,isAuthenticated:!0})},logout:()=>{e({token:null,user:null,isAuthenticated:!1})}}),{name:"auth-storage",storage:{getItem:e=>{let t=localStorage.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch(e){return null}},setItem:(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},removeItem:e=>{localStorage.removeItem(e)}}}))}}]);