(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7187],{12558:(e,s,t)=>{"use strict";t.d(s,{cn:()=>l});var a=t(43463),r=t(69795);function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.QP)((0,a.$)(s))}},38684:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},43031:(e,s,t)=>{"use strict";t.d(s,{p:()=>n});var a=t(95155),r=t(12115),l=t(12558);let n=r.forwardRef((e,s)=>{let{className:t,type:r,label:n,error:i,...c}=e;return(0,a.jsxs)("div",{className:"w-full",children:[n&&(0,a.jsx)("label",{htmlFor:c.id,className:"block text-sm font-medium text-gray-700 mb-1",children:n}),(0,a.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",i?"border-red-500 focus-visible:ring-red-500":"",t),ref:s,...c}),i&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:i})]})});n.displayName="Input"},46473:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f});var a=t(95155),r=t(12115),l=t(76046),n=t(55037),i=t(87364),c=t(38684),o=t(92823),d=t(66889),m=t(67072),u=t(87780),p=t(1169),y=t(19393),h=t(43031),g=t(85725),x=t(73746);function b(e){var s;let{campaignId:t}=e,b=(0,l.useRouter)(),{isAuthenticated:f}=(0,x.n)(),[v,j]=(0,r.useState)(!0),[N,w]=(0,r.useState)(!1),[A,k]=(0,r.useState)(!1),[C,T]=(0,r.useState)({id:0,name:"",status:"",rateLimit:60,autoReplyEnabled:!1,replyTemplate:"",messageTemplate:""});(0,r.useEffect)(()=>{if(!f){b.push("/login");return}E()},[f,b,t]);let E=async()=>{j(!0);try{let e=await (0,g.mI)(parseInt(t));T({id:e.id,name:e.name,status:e.status,rateLimit:e.rateLimit,autoReplyEnabled:e.autoReplyEnabled,replyTemplate:e.replyTemplate||"",messageTemplate:e.messageTemplate,contactStats:e.contactStats})}catch(e){console.error("Error fetching campaign settings:",e),(0,n.Ay)("Failed to load campaign settings")}finally{j(!1)}},R=async e=>{if(e.preventDefault(),w(!0),C.rateLimit<1||C.rateLimit>1e4){n.Ay.error("Rate limit must be between 1 and 10000 messages per hour"),w(!1);return}if(!C.messageTemplate.trim()){n.Ay.error("Message template cannot be empty"),w(!1);return}if(C.autoReplyEnabled&&!C.replyTemplate.trim()){n.Ay.error("Auto-reply template cannot be empty when auto-reply is enabled"),w(!1);return}let s=!1,t=0;for(;!s&&t<=2;)try{await (0,g.Ah)(C.id,C.rateLimit),s=!0}catch(e){if(console.error("Error saving rate limit (attempt ".concat(t+1,"/").concat(3,"):"),e),++t>2){if(window.confirm("Having trouble connecting to save rate limit settings. Do you want to:\n\n- Click OK to continue with other settings without rate limit change\n- Click Cancel to stop the save process entirely"))(0,n.Ay)("Rate limit not saved due to connection issues, continuing with other settings.");else{n.Ay.error("Settings save cancelled."),w(!1);return}}else await new Promise(e=>setTimeout(e,1e3*t))}try{await (0,g.s3)(C.id,{autoReplyEnabled:C.autoReplyEnabled,replyTemplate:C.replyTemplate}),s?n.Ay.success("All settings saved successfully"):n.Ay.success("Auto-reply settings saved successfully"),b.refresh()}catch(e){console.error("Error saving auto-reply settings:",e),n.Ay.error("Failed to save auto-reply settings")}finally{w(!1)}},S=async()=>{if(window.confirm("Are you sure you want to ".concat("active"===C.status?"pause":"start"," this campaign?")))try{"active"===C.status?(await (0,g.kb)(C.id),T(e=>({...e,status:"paused"})),n.Ay.success("Campaign paused successfully")):(await (0,g.Kl)(C.id),T(e=>({...e,status:"active"})),n.Ay.success("Campaign started successfully"))}catch(e){console.error("Error toggling campaign status:",e),n.Ay.error("Failed to update campaign status. Please try again.")}},L=async()=>{var e;if(!C.id)return;let s=(null===(e=C.contactStats)||void 0===e?void 0:e.unresponded)||0;if(0===s){(0,n.Ay)("No unresponded messages to clear");return}if(window.confirm("Are you sure you want to mark all ".concat(s," unresponded messages for this campaign as resolved?"))){k(!0);try{let e=await (0,g.$2)(C.id);n.Ay.success(e.message||"Unresponded messages cleared successfully"),E()}catch(e){console.error("Error clearing unresponded messages:",e),n.Ay.error("Failed to clear unresponded messages. Please try again.")}finally{k(!1)}}},M=()=>{b.push("/sms/upload?campaignId=".concat(t))};return f?(0,a.jsx)(p.A,{children:(0,a.jsxs)("div",{className:"py-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(y.$,{variant:"ghost",onClick:()=>b.back(),className:"mr-4",children:(0,a.jsx)(i.A,{className:"w-4 h-4"})}),(0,a.jsxs)("h1",{className:"text-2xl font-semibold text-gray-900",children:["Campaign Settings: ",C.name]})]}),(0,a.jsxs)(y.$,{variant:"brand",onClick:M,className:"flex items-center",children:[(0,a.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Upload Leads"]})]}),v?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-500",children:"Loading settings..."})]}):(0,a.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,a.jsx)("div",{className:"px-4 py-5 sm:p-6",children:(0,a.jsxs)("form",{onSubmit:R,className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Campaign Status"}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["Current status: ",(0,a.jsx)("span",{className:"font-medium ".concat("active"===C.status?"text-green-600":"text-yellow-600"),children:C.status})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)(y.$,{type:"button",variant:"outline",onClick:M,children:[(0,a.jsx)(o.A,{className:"w-4 h-4 mr-2"}),"Upload Contacts"]}),(0,a.jsx)(y.$,{type:"button",variant:"active"===C.status?"secondary":"brand",onClick:S,disabled:"completed"===C.status,children:"active"===C.status?"Pause Campaign":"draft"===C.status||"paused"===C.status?"Start Campaign":"Campaign Completed"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"rateLimit",className:"block text-sm font-medium text-gray-700",children:"Rate Limit (messages per hour)"}),(0,a.jsxs)("div",{className:"mt-1 flex items-center",children:[(0,a.jsx)(d.A,{className:"h-5 w-5 text-gray-400 mr-2"}),(0,a.jsx)(h.p,{type:"number",id:"rateLimit",value:C.rateLimit,onChange:e=>T(s=>({...s,rateLimit:parseInt(e.target.value,10)||0})),min:"1",max:"10000",className:"w-32"})]}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Maximum number of messages that can be sent per hour."})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("input",{type:"checkbox",id:"autoReplyEnabled",checked:C.autoReplyEnabled,onChange:e=>T(s=>({...s,autoReplyEnabled:e.target.checked})),className:"h-4 w-4 text-brand focus:ring-brand border-gray-300 rounded"}),(0,a.jsx)("label",{htmlFor:"autoReplyEnabled",className:"text-sm font-medium text-gray-700",children:"Enable Auto-Reply"})]}),C.autoReplyEnabled&&(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("label",{htmlFor:"replyTemplate",className:"block text-sm font-medium text-gray-700",children:"Auto-Reply Message"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("textarea",{id:"replyTemplate",rows:3,value:C.replyTemplate,onChange:e=>T(s=>({...s,replyTemplate:e.target.value})),className:"shadow-sm focus:ring-brand focus:border-brand block w-full sm:text-sm border border-gray-300 rounded-md",placeholder:"Thank you for your message. We'll get back to you soon."})}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"This message will be sent automatically when you receive a message."})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"messageTemplate",className:"block text-sm font-medium text-gray-700",children:"Campaign Message Template"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("textarea",{id:"messageTemplate",rows:5,value:C.messageTemplate,onChange:e=>T(s=>({...s,messageTemplate:e.target.value})),className:"shadow-sm focus:ring-brand focus:border-brand block w-full sm:text-sm border border-gray-300 rounded-md",placeholder:"Hi {name}, this is a message for you..."})}),(0,a.jsxs)("p",{className:"mt-2 text-sm text-gray-500",children:["Use ","{name}",", ","{phone}",", ","{email}"," and other contact custom fields as placeholders."]})]}),(0,a.jsxs)("div",{className:"border-t pt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Manage Unresponded Messages"}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["Mark all currently unresponded messages for this campaign as resolved.","number"==typeof(null===(s=C.contactStats)||void 0===s?void 0:s.unresponded)&&C.contactStats.unresponded>0&&"There are currently ".concat(C.contactStats.unresponded," unresponded messages.")]}),(0,a.jsxs)(y.$,{type:"button",variant:"outline",onClick:L,isLoading:A,disabled:A,className:"mt-3",children:[(0,a.jsx)(m.A,{className:"w-4 h-4 mr-2"}),"Clear All Unresponded"]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 border-t pt-6",children:[(0,a.jsx)(y.$,{type:"button",variant:"secondary",onClick:()=>b.back(),children:"Cancel"}),(0,a.jsxs)(y.$,{type:"submit",variant:"brand",isLoading:N,children:[(0,a.jsx)(u.A,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})})})]})}):null}function f(e){let{params:s}=e;return(0,a.jsx)(b,{campaignId:s.id})}},48585:(e,s,t)=>{Promise.resolve().then(t.bind(t,46473))},66889:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},67072:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},87364:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},87780:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[9272,2376,6514,5037,1169,1485,8441,6587,7358],()=>s(48585)),_N_E=e.O()}]);