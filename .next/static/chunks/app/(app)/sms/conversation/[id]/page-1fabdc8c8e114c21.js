(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3437],{12558:(e,t,s)=>{"use strict";s.d(t,{cn:()=>l});var r=s(43463),a=s(69795);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}},28283:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(67401).A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},40499:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var r=s(95155),a=s(12115),l=s(76046),n=s(55037),i=s(87364),d=s(28283),o=s(1169),c=s(19393),u=s(43031),m=s(85725),x=s(73746);function f(){let e=(0,l.useParams)(),t=(0,l.useRouter)(),{isAuthenticated:s}=(0,x.n)(),[f,h]=(0,a.useState)(null),[g,b]=(0,a.useState)([]),[v,y]=(0,a.useState)(!0),[p,j]=(0,a.useState)(""),[N,w]=(0,a.useState)(!1),A=(0,a.useRef)(null),k=parseInt(e.id,10);(0,a.useEffect)(()=>{if(!s){t.push("/login");return}S();let e=setInterval(()=>{S(!1)},1e4);return()=>clearInterval(e)},[s,t,k]),(0,a.useEffect)(()=>{E()},[g]);let S=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];e&&y(!0);try{let e=await (0,m.Ag)(k);h(e.contact),b(e.messages)}catch(e){console.error("Error fetching conversation:",e),n.Ay.error("Failed to load conversation")}finally{e&&y(!1)}},E=()=>{var e;null===(e=A.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},_=async e=>{if(e.preventDefault(),!p.trim()){n.Ay.error("Please enter a message");return}w(!0);try{let e=await (0,m.B9)(k,p);b([...g,e.sentMessage]),j(""),n.Ay.success("Reply sent")}catch(e){console.error("Error sending reply:",e),n.Ay.error("Failed to send reply")}finally{w(!1)}},C=e=>{let t=new Date(e);return t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})+" "+t.toLocaleDateString([],{month:"short",day:"numeric"})};return s?(0,r.jsx)(o.A,{children:(0,r.jsxs)("div",{className:"py-6 h-full flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center mb-6",children:[(0,r.jsx)(c.$,{variant:"ghost",onClick:()=>t.back(),className:"mr-4",children:(0,r.jsx)(i.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:(null==f?void 0:f.name)||"Contact"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:null==f?void 0:f.phone})]})]}),v?(0,r.jsx)("div",{className:"flex-grow flex justify-center items-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex-grow bg-white shadow overflow-hidden sm:rounded-lg p-4 mb-4 overflow-y-auto",children:(0,r.jsxs)("div",{className:"space-y-4",children:[0===g.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No messages in this conversation yet"}):g.map(e=>(0,r.jsx)("div",{className:"flex ".concat("outbound"===e.direction?"justify-end":"justify-start"),children:(0,r.jsxs)("div",{className:"max-w-xs sm:max-w-sm md:max-w-md rounded-lg px-4 py-2 \n                          ".concat("outbound"===e.direction?"bg-brand text-white rounded-br-none":"bg-gray-200 text-gray-900 rounded-bl-none"),children:[(0,r.jsx)("div",{className:"text-sm",children:e.content}),(0,r.jsx)("div",{className:"text-xs mt-1 ".concat("outbound"===e.direction?"text-blue-100":"text-gray-500"),children:C(e.sentAt)})]})},e.id)),(0,r.jsx)("div",{ref:A})]})}),(0,r.jsx)("div",{className:"bg-white shadow sm:rounded-lg p-4",children:(0,r.jsxs)("form",{onSubmit:_,className:"flex space-x-2",children:[(0,r.jsx)("div",{className:"flex-grow",children:(0,r.jsx)(u.p,{type:"text",value:p,onChange:e=>j(e.target.value),placeholder:"Type your reply...",disabled:N,className:"w-full",autoFocus:!0})}),(0,r.jsxs)(c.$,{type:"submit",variant:"brand",isLoading:N,disabled:N||!p.trim(),children:[(0,r.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Send"]})]})})]})]})}):null}},43031:(e,t,s)=>{"use strict";s.d(t,{p:()=>n});var r=s(95155),a=s(12115),l=s(12558);let n=a.forwardRef((e,t)=>{let{className:s,type:a,label:n,error:i,...d}=e;return(0,r.jsxs)("div",{className:"w-full",children:[n&&(0,r.jsx)("label",{htmlFor:d.id,className:"block text-sm font-medium text-gray-700 mb-1",children:n}),(0,r.jsx)("input",{type:a,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",i?"border-red-500 focus-visible:ring-red-500":"",s),ref:t,...d}),i&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:i})]})});n.displayName="Input"},68407:(e,t,s)=>{Promise.resolve().then(s.bind(s,40499))},87364:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(67401).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[9272,2376,6514,5037,1169,1485,8441,6587,7358],()=>t(68407)),_N_E=e.O()}]);