(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[293],{12558:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(43463),n=a(69795);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,s.$)(t))}},15342:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var s=a(95155),n=a(12115),l=a(76046),r=a(55037),i=a(33473),c=a(26764);let o=(0,a(67401).A)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var d=a(45686),p=a(1169),m=a(19393),x=a(43031),u=a(66798);function h(){let e=(0,l.useRouter)(),[t,a]=(0,n.useState)([]),[h,y]=(0,n.useState)(!0),[g,j]=(0,n.useState)(!1),[f,v]=(0,n.useState)(!1),[w,N]=(0,n.useState)(null),[b,A]=(0,n.useState)({name:"",description:""}),[k,C]=(0,n.useState)(""),[D,P]=(0,n.useState)(null),[S,E]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{try{let e=await (0,u.cV)();console.log("Dialplan capabilities:",e),P(e),I()}catch(e){console.error("Error checking dial plan capabilities:",e),E("Failed to connect to dial plan service. Please try again later."),y(!1),r.Ay.error("Failed to connect to dial plan service")}})()},[]);let I=async()=>{y(!0);try{let e=await (0,u.ac)();console.log("Projects data:",e),a(Array.isArray(e)?e:[])}catch(e){console.error("Error fetching projects:",e),E("Failed to load dialplan projects. Please try again later."),r.Ay.error("Failed to load dial plan projects")}finally{y(!1)}},q=async e=>{e.preventDefault();try{let e=await (0,u.gA)(b);console.log("Created project:",e),r.Ay.success("Project created successfully"),A({name:"",description:""}),j(!1),I()}catch(e){console.error("Error creating project:",e),r.Ay.error("Failed to create project")}},F=async e=>{if(confirm("Are you sure you want to delete this project? This action cannot be undone."))try{let t=await (0,u.xx)(e);console.log("Delete result:",t),r.Ay.success("Project deleted successfully"),I()}catch(e){console.error("Error deleting project:",e),r.Ay.error("Failed to delete project")}},M=async e=>{if(e.preventDefault(),w)try{let e=await (0,u.BL)(w,k);console.log("Cloned project:",e),r.Ay.success("Project cloned successfully"),C(""),v(!1),N(null),I()}catch(e){console.error("Error cloning project:",e),r.Ay.error("Failed to clone project")}},$=(e,t)=>{N(e),C("".concat(t," Copy")),v(!0)},B=e=>{if(!e)return"Never";try{return new Date(e).toLocaleString()}catch(e){return"Invalid date"}};return h&&!D?(0,s.jsx)(p.A,{children:(0,s.jsxs)("div",{className:"py-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,s.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Asterisk Dial Plan Builder"})}),(0,s.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"text-gray-500",children:"Checking Dial Plan Builder capabilities..."})})})]})}):S?(0,s.jsx)(p.A,{children:(0,s.jsxs)("div",{className:"py-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,s.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Asterisk Dial Plan Builder"})}),(0,s.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:(0,s.jsxs)("div",{className:"text-center py-10",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-red-600 mb-2",children:"Error"}),(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:S}),(0,s.jsx)(m.$,{variant:"default",onClick:()=>window.location.reload(),children:"Retry"})]})})]})}):!D||D.capabilities&&D.capabilities.generator?(0,s.jsx)(p.A,{children:(0,s.jsxs)("div",{className:"py-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Asterisk Dial Plan Builder"}),(0,s.jsxs)(m.$,{onClick:()=>j(!g),variant:"default",children:[(0,s.jsx)(i.A,{className:"w-4 h-4 mr-2"}),"New Project"]})]}),g&&(0,s.jsxs)("div",{className:"mb-6 bg-white shadow px-4 py-5 sm:rounded-lg sm:p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Create New Project"}),(0,s.jsxs)("form",{onSubmit:q,children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6",children:[(0,s.jsx)("div",{className:"sm:col-span-3",children:(0,s.jsx)(x.p,{id:"projectName",label:"Project Name",type:"text",value:b.name,onChange:e=>A({...b,name:e.target.value}),required:!0})}),(0,s.jsxs)("div",{className:"sm:col-span-6",children:[(0,s.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)("textarea",{id:"description",rows:3,className:"shadow-sm focus:ring-brand focus:border-brand block w-full sm:text-sm border border-gray-300 rounded-md",value:b.description,onChange:e=>A({...b,description:e.target.value})})})]})]}),(0,s.jsxs)("div",{className:"mt-5 sm:mt-6 flex justify-end space-x-3",children:[(0,s.jsx)(m.$,{type:"button",variant:"secondary",onClick:()=>j(!1),children:"Cancel"}),(0,s.jsx)(m.$,{type:"submit",variant:"default",disabled:!b.name,children:"Create Project"})]})]})]}),f&&(0,s.jsxs)("div",{className:"mb-6 bg-white shadow px-4 py-5 sm:rounded-lg sm:p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Clone Project"}),(0,s.jsxs)("form",{onSubmit:M,children:[(0,s.jsx)("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6",children:(0,s.jsx)("div",{className:"sm:col-span-3",children:(0,s.jsx)(x.p,{id:"newProjectName",label:"New Project Name",type:"text",value:k,onChange:e=>C(e.target.value),required:!0})})}),(0,s.jsxs)("div",{className:"mt-5 sm:mt-6 flex justify-end space-x-3",children:[(0,s.jsx)(m.$,{type:"button",variant:"secondary",onClick:()=>{v(!1),N(null)},children:"Cancel"}),(0,s.jsx)(m.$,{type:"submit",variant:"default",disabled:!k,children:"Clone Project"})]})]})]}),(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-4 py-5 sm:px-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Dial Plan Projects"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Create and manage Asterisk dial plan configurations."})]}),h?(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand"})}):0===t.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No projects found"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new dial plan project."})]}):(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project Name"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Deployed"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(t=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t.name})}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("div",{className:"text-sm text-gray-500 max-w-md truncate",children:t.description})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(t.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:t.isActive?"Active":"Inactive"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:B(t.lastDeployed)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex space-x-1",children:[(0,s.jsxs)(m.$,{onClick:()=>e.push("/dialplan/".concat(t.id)),variant:"outline",size:"sm",className:"text-brand",children:[(0,s.jsx)(c.A,{className:"w-4 h-4 mr-1"}),"Edit"]}),(0,s.jsxs)(m.$,{onClick:()=>$(t.id,t.name),variant:"outline",size:"sm",children:[(0,s.jsx)(o,{className:"w-4 h-4 mr-1"}),"Clone"]}),(0,s.jsxs)(m.$,{onClick:()=>F(t.id),variant:"outline",size:"sm",className:"text-red-500 hover:text-red-700",children:[(0,s.jsx)(d.A,{className:"w-4 h-4 mr-1"}),"Delete"]})]})})]},t.id))})]})]})]})}):(0,s.jsx)(p.A,{children:(0,s.jsxs)("div",{className:"py-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,s.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Asterisk Dial Plan Builder"})}),(0,s.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:(0,s.jsxs)("div",{className:"text-center py-10",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-red-600 mb-2",children:"Dial Plan Builder Module Limited"}),(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:"The Asterisk Dial Plan Builder module has limited capabilities. Some features may not work properly."}),(0,s.jsxs)("p",{className:"text-sm text-gray-400",children:["Message: ",D.message]})]})})]})})}},26764:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(67401).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},33473:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(67401).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},43031:(e,t,a)=>{"use strict";a.d(t,{p:()=>r});var s=a(95155),n=a(12115),l=a(12558);let r=n.forwardRef((e,t)=>{let{className:a,type:n,label:r,error:i,...c}=e;return(0,s.jsxs)("div",{className:"w-full",children:[r&&(0,s.jsx)("label",{htmlFor:c.id,className:"block text-sm font-medium text-gray-700 mb-1",children:r}),(0,s.jsx)("input",{type:n,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",i?"border-red-500 focus-visible:ring-red-500":"",a),ref:t,...c}),i&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:i})]})});r.displayName="Input"},45686:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(67401).A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},62449:(e,t,a)=>{Promise.resolve().then(a.bind(a,15342))},66798:(e,t,a)=>{"use strict";a.d(t,{AC:()=>u,BL:()=>c,ES:()=>l,OK:()=>x,RM:()=>m,U$:()=>f,YE:()=>y,aN:()=>j,ac:()=>n,cV:()=>w,g5:()=>h,gA:()=>r,ht:()=>o,mJ:()=>p,q6:()=>d,tq:()=>g,v:()=>v,xx:()=>i});var s=a(85725);let n=async()=>(await s.Ay.get("/dialplan/projects")).data,l=async e=>(await s.Ay.get("/dialplan/projects/".concat(e))).data,r=async e=>(await s.Ay.post("/dialplan/projects",e)).data,i=async e=>(await s.Ay.delete("/dialplan/projects/".concat(e))).data,c=async(e,t)=>(await s.Ay.post("/dialplan/projects/".concat(e,"/clone"),{newName:t})).data,o=async e=>(await s.Ay.get("/dialplan/projects/".concat(e,"/contexts"))).data,d=async(e,t)=>(await s.Ay.post("/dialplan/projects/".concat(e,"/contexts"),t)).data,p=async e=>(await s.Ay.get("/dialplan/contexts/".concat(e,"/nodes"))).data,m=async(e,t)=>{try{console.log("Creating node with data:",{contextId:e,data:t});let a=await s.Ay.post("/dialplan/contexts/".concat(e,"/nodes"),t);return console.log("Node creation successful:",a.data),a.data}catch(e){var a;throw console.error("Node creation failed:",(null===(a=e.response)||void 0===a?void 0:a.data)||e.message||e),e}},x=async(e,t)=>(await s.Ay.put("/dialplan/nodes/".concat(e),t)).data,u=async e=>{var t,a;try{if(console.log("Deleting node with ID:",e),!e||isNaN(e))throw Error("Invalid node ID");try{let t=await s.Ay.delete("/dialplan/nodes/".concat(e));return console.log("Node deletion successful:",t.data),t.data}catch(a){if((null===(t=a.response)||void 0===t?void 0:t.status)===404){console.warn("Standard delete endpoint not found, trying alternate endpoint...");let t=await s.Ay.post("/dialplan/nodes/delete",{id:e});return console.log("Node deletion successful with fallback:",t.data),t.data}throw a}}catch(s){s.response?console.error("Node deletion failed with response:",{status:s.response.status,data:s.response.data,headers:s.response.headers}):s.request?console.error("Node deletion failed - no response received:",s.request):console.error("Node deletion failed - error setting up request:",s.message);let e="Failed to delete node";(null===(a=s.response)||void 0===a?void 0:a.status)===404?e="The node delete endpoint was not found on the server. The API may not be fully implemented.":s.message&&(e=s.message);let t=Error(e);throw t.cause=s,t}},h=async()=>(await s.Ay.get("/dialplan/node-types")).data,y=async e=>(await s.Ay.get("/dialplan/contexts/".concat(e,"/connections"))).data,g=async e=>{try{console.log("Creating connection with data:",e);let t=await s.Ay.post("/dialplan/connections",e);return console.log("Connection creation successful:",t.data),t.data}catch(e){var t;throw console.error("Connection creation failed:",(null===(t=e.response)||void 0===t?void 0:t.data)||e.message||e),e}},j=async e=>{var t,a;try{if(console.log("Deleting connection with ID:",e),!e||isNaN(e))throw Error("Invalid connection ID");try{let t=await s.Ay.delete("/dialplan/connections/".concat(e));return console.log("Connection deletion successful:",t.data),t.data}catch(a){if((null===(t=a.response)||void 0===t?void 0:t.status)===404){console.warn("Standard connection delete endpoint not found, trying alternate endpoint...");let t=await s.Ay.post("/dialplan/connections/delete",{id:e});return console.log("Connection deletion successful with fallback:",t.data),t.data}throw a}}catch(s){s.response?console.error("Connection deletion failed with response:",{status:s.response.status,data:s.response.data}):s.request?console.error("Connection deletion failed - no response received:",s.request):console.error("Connection deletion failed - error setting up request:",s.message);let e="Failed to delete connection";(null===(a=s.response)||void 0===a?void 0:a.status)===404?e="The connection delete endpoint was not found on the server. The API may not be fully implemented.":s.message&&(e=s.message);let t=Error(e);throw t.cause=s,t}},f=async e=>{try{return(await s.Ay.post("/dialplan/projects/".concat(e,"/validate"))).data}catch(e){return console.warn("Validate project endpoint may not be implemented yet"),{valid:!0,errors:[],warnings:[],timestamp:new Date().toISOString()}}},v=async e=>{try{return(await s.Ay.post("/dialplan/projects/".concat(e,"/generate"))).data}catch(e){return console.warn("Generate dialplan endpoint may not be implemented yet"),{dialplan:"[default]\nexten => s,1,NoOp(Demo Dialplan)\nexten => s,n,Hangup()",project:"Demo Project",contexts:1,timestamp:new Date().toISOString()}}},w=async()=>(await s.Ay.get("/system/dialplan-capabilities")).data}},e=>{var t=t=>e(e.s=t);e.O(0,[9272,2376,6514,5037,1169,1485,8441,6587,7358],()=>t(62449)),_N_E=e.O()}]);