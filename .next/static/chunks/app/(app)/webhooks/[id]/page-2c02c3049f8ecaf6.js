(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6940],{12558:(e,s,t)=>{"use strict";t.d(s,{cn:()=>i});var a=t(43463),r=t(69795);function i(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.QP)((0,a.$)(s))}},19393:(e,s,t)=>{"use strict";t.d(s,{$:()=>d});var a=t(95155),r=t(12115),i=t(31027),l=t(67910);let n=(0,i.F)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",brand:"bg-brand text-white hover:bg-brand/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,s)=>{let{className:t,variant:r,size:i,asChild:d=!1,isLoading:c,children:o,disabled:x,...m}=e;return(0,a.jsx)("button",{className:(0,l.cn)(n({variant:r,size:i,className:t})),ref:s,disabled:x||c,...m,children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o]}):o})});d.displayName="Button"},20411:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>b});var a=t(95155),r=t(12115),i=t(76046),l=t(1169),n=t(19393),d=t(52107),c=t(97754),o=t(63669),x=t(34639),m=t(55037),h=t(60872),u=t(67401);let p=(0,u.A)("clipboard-copy",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2",key:"4jdomd"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v4",key:"3hqy98"}],["path",{d:"M21 14H11",key:"1bme5i"}],["path",{d:"m15 10-4 4 4 4",key:"5dvupr"}]]),g=(0,u.A)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);var j=t(42640),y=t(21773),f=t(29191),v=t(76631),N=t(2818);function b(e){var s,t,u;let{params:b}=e,w=(0,i.useRouter)(),k=parseInt(b.id),[R,E]=(0,r.useState)(!0),[A,S]=(0,r.useState)(null),[C,T]=(0,r.useState)([]),[L,M]=(0,r.useState)(null),[_,F]=(0,r.useState)(""),[B,I]=(0,r.useState)(!1),[P,J]=(0,r.useState)(null),[W,O]=(0,r.useState)("details"),[q,D]=(0,r.useState)(!1),U=async e=>{try{let s=await x.Ay.journeys.get(e.toString());M(s.data)}catch(e){console.error("Error fetching journey details:",e),M(null)}},V=async()=>{E(!0);try{let e=await x.Ay.webhooks.get(k.toString()),s=e.data||e;if(S(s),s.autoEnrollJourneyId&&await U(s.autoEnrollJourneyId),s.testPayload)F(JSON.stringify(s.testPayload,null,2));else{let e={};s.fieldMapping.phone&&(e[s.fieldMapping.phone]="5551234567"),s.fieldMapping.name&&(e[s.fieldMapping.name]="John Doe"),s.fieldMapping.email&&(e[s.fieldMapping.email]="john@example.com"),F(JSON.stringify(e,null,2))}}catch(e){console.error("Error fetching webhook details:",e),m.oR.error("Failed to load webhook details")}},Z=async()=>{E(!0);try{let e=await x.Ay.webhooks.getEvents(k.toString(),{page:1,limit:20}),s=e.data||e;T(s.events||s||[])}catch(e){console.error("Error fetching webhook events:",e),m.oR.error("Failed to load events")}finally{E(!1)}};(0,r.useEffect)(()=>{b.id&&(V(),Z())},[b.id,V,Z]);let $=async()=>{if(confirm("Are you sure? This will invalidate the current endpoint key.")){D(!0);try{let e=await x.Ay.webhooks.regenerateKey(k.toString()),s=e.data||e;S(e=>e?{...e,endpointKey:s.endpointKey}:null),m.oR.success("Endpoint key regenerated")}catch(e){console.error("Error regenerating key:",e),m.oR.error("Failed to regenerate key")}finally{D(!1)}}},z=async()=>{if(confirm("Are you sure? This will invalidate the current authentication token.")){D(!0);try{let e=await x.Ay.webhooks.regenerateToken(k.toString()),s=e.data||e;S(e=>e?{...e,authToken:s.authToken}:null),m.oR.success("Authentication token regenerated")}catch(e){console.error("Error regenerating token:",e),m.oR.error("Failed to regenerate token")}finally{D(!1)}}},H=async()=>{I(!0),J(null);try{let e;try{e=JSON.parse(_)}catch(e){m.oR.error("Invalid JSON payload");return}let s=await x.Ay.webhooks.test(k.toString(),e);J(s),m.oR.success("Webhook test completed")}catch(e){console.error("Error testing webhook:",e),m.oR.error("Failed to test webhook")}finally{I(!1)}};return(0,a.jsx)(l.A,{children:(0,a.jsxs)("div",{className:"container mx-auto py-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:R?"Loading webhook...":null==A?void 0:A.name}),A&&(0,a.jsx)("p",{className:"text-gray-500",children:A.description})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(n.$,{onClick:()=>{w.push("/webhooks/edit/".concat(k))},className:"flex items-center gap-2",children:[(0,a.jsx)(h.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Edit"})]}),(0,a.jsx)(n.$,{variant:"outline",onClick:()=>w.push("/webhooks"),className:"flex items-center gap-2",children:"Back to List"})]})]}),R?(0,a.jsx)("div",{className:"text-center py-8",children:"Loading webhook details..."}):A?(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(o.tU,{defaultValue:"details",value:W,onValueChange:O,children:[(0,a.jsxs)(o.j7,{children:[(0,a.jsx)(o.Xi,{value:"details",children:"Details"}),(0,a.jsx)(o.Xi,{value:"events",children:"Events"}),(0,a.jsx)(o.Xi,{value:"testing",children:"Testing"}),(null===(s=A.conditionalRules)||void 0===s?void 0:s.enabled)&&(0,a.jsx)(o.Xi,{value:"rules",children:"Conditional Rules"})]}),(0,a.jsx)(o.av,{value:"details",className:"space-y-4 pt-4",children:(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"Webhook Details"}),(0,a.jsx)(d.BT,{children:"Configuration details for this webhook endpoint."})]}),(0,a.jsxs)(d.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Status"}),(0,a.jsx)(c.E,{variant:A.isActive?"default":"secondary",className:"mt-1",children:A.isActive?"Active":"Inactive"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Created"}),(0,a.jsx)("p",{className:"text-gray-900",children:new Date(A.createdAt).toLocaleString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Brand"}),(0,a.jsx)("p",{className:"text-gray-900",children:A.brand})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Source"}),(0,a.jsx)("p",{className:"text-gray-900",children:A.source})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Webhook URL"}),(0,a.jsxs)("div",{className:"flex items-center mt-1 gap-2",children:[(0,a.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded text-sm flex-1",children:A.webhookUrl||"".concat(N.env.NEXT_PUBLIC_API_URL,"/api/webhook-receiver/").concat(A.endpointKey)}),(0,a.jsx)(n.$,{variant:"ghost",size:"sm",onClick:()=>{if(!A)return;let e=A.webhookUrl||"".concat(N.env.NEXT_PUBLIC_API_URL,"/api/webhook-receiver/").concat(A.endpointKey);navigator.clipboard.writeText(e),m.oR.success("Webhook URL copied to clipboard")},children:(0,a.jsx)(p,{className:"h-4 w-4"})}),(0,a.jsxs)(n.$,{variant:"outline",size:"sm",onClick:$,disabled:q,children:[(0,a.jsx)(g,{className:"h-4 w-4 mr-1"}),"Regenerate Key"]})]})]})]}),(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Field Mapping"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Lead Field"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Source Field"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.entries(A.fieldMapping).map(e=>{let[s,t]=e;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:s}),(0,a.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:(0,a.jsx)("code",{className:"bg-gray-100 px-1 rounded text-xs",children:t})})]},s)})})]})})]}),(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Validation Rules"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Require Phone: "}),A.validationRules.requirePhone?"Yes":"No"]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Require Name: "}),A.validationRules.requireName?"Yes":"No"]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Require Email: "}),A.validationRules.requireEmail?"Yes":"No"]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Allow Duplicate Phone: "}),A.validationRules.allowDuplicatePhone?"Yes":"No"]})})]})]}),A.autoTagRules&&A.autoTagRules.length>0&&(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Auto Tag Rules"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Field"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Condition"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Tag"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:A.autoTagRules.map((e,s)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:(0,a.jsx)("code",{className:"bg-gray-100 px-1 rounded text-xs",children:e.field})}),(0,a.jsxs)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:["equals"===e.operator&&(0,a.jsxs)(a.Fragment,{children:["equals ",(0,a.jsxs)("strong",{children:['"',e.value,'"']})]}),"contains"===e.operator&&(0,a.jsxs)(a.Fragment,{children:["contains ",(0,a.jsxs)("strong",{children:['"',e.value,'"']})]}),"exists"===e.operator&&(0,a.jsx)(a.Fragment,{children:"exists"})]}),(0,a.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:(0,a.jsx)(c.E,{variant:"outline",children:e.tag})})]},s))})]})})]}),A.securityToken&&(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Security"}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-sm",children:"Security Token: "}),(0,a.jsx)("code",{className:"bg-gray-100 px-1 rounded text-xs",children:A.securityToken})]}),(0,a.jsxs)(n.$,{variant:"outline",size:"sm",onClick:z,disabled:q,children:[(0,a.jsx)(j.A,{className:"h-4 w-4 mr-1"}),"Regenerate Token"]})]})]}),A.requiredHeaders&&Object.keys(A.requiredHeaders).length>0&&(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Required Headers"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Header"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Value"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.entries(A.requiredHeaders).map(e=>{let[s,t]=e;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:s}),(0,a.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:(0,a.jsx)("code",{className:"bg-gray-100 px-1 rounded text-xs",children:t})})]},s)})})]})})]}),(A.autoEnrollJourneyId||L)&&(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Auto Enrollment"}),L?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:L.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:L.description})]}),(0,a.jsx)(c.E,{variant:L.isActive?"default":"secondary",children:L.isActive?"Active":"Inactive"})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Journey ID: ",A.autoEnrollJourneyId]})]}):(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Auto Enroll Journey ID: "}),A.autoEnrollJourneyId,(0,a.jsx)("span",{className:"text-xs text-red-500 ml-2",children:"(Journey not found)"})]})]})]})]})}),(0,a.jsx)(o.av,{value:"events",className:"space-y-4 pt-4",children:(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"Webhook Events"}),(0,a.jsx)(d.BT,{children:"Recent events received by this webhook."})]}),(0,a.jsx)(d.Wu,{children:0===C.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"No events recorded for this webhook"}),(0,a.jsx)(n.$,{variant:"outline",onClick:()=>O("testing"),children:"Test Webhook"})]}):(0,a.jsx)("div",{className:"space-y-4",children:C.map(e=>(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(c.E,{variant:"success"===e.status?"default":"partial_success"===e.status?"outline":"destructive",children:e.status}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:new Date(e.receivedAt).toLocaleString()}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[e.processingTime,"ms"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["IP: ",e.ipAddress]}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Leads: ",e.createdLeadIds.length]})]})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Payload"}),(0,a.jsx)("div",{className:"bg-gray-50 rounded p-3 text-xs font-mono max-h-32 overflow-y-auto",children:(0,a.jsx)("pre",{children:JSON.stringify(e.payload,null,2)})})]}),"failed"===e.status&&e.errorMessage&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-red-700 mb-2",children:"Error Details"}),(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:(0,a.jsx)("p",{className:"text-sm text-red-800",children:e.errorMessage})})]}),"partial_success"===e.status&&e.errorMessage&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-yellow-700 mb-2",children:"Warnings"}),(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-3",children:(0,a.jsx)("p",{className:"text-sm text-yellow-800",children:e.errorMessage})})]}),"success"===e.status&&e.createdLeadIds.length>0&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-green-700 mb-2",children:["Successfully Created Leads (",e.createdLeadIds.length,")"]}),(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded p-3",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:e.createdLeadIds.map(e=>(0,a.jsxs)(c.E,{variant:"outline",className:"text-xs",children:["Lead #",e]},e))})})]}),(0,a.jsxs)("details",{className:"mt-3",children:[(0,a.jsx)("summary",{className:"text-sm text-gray-500 cursor-pointer hover:text-gray-700",children:"View Raw Event Data"}),(0,a.jsx)("div",{className:"mt-2 bg-gray-50 rounded p-3 text-xs font-mono max-h-40 overflow-y-auto",children:(0,a.jsx)("pre",{children:JSON.stringify(e,null,2)})})]})]},e.id))})}),(0,a.jsx)(d.wL,{children:(0,a.jsxs)(n.$,{variant:"ghost",size:"sm",onClick:Z,className:"ml-auto",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Refresh Events"]})})]})}),(0,a.jsx)(o.av,{value:"testing",className:"space-y-4 pt-4",children:(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"Test Webhook"}),(0,a.jsx)(d.BT,{children:"Send a test payload to this webhook without creating actual leads."})]}),(0,a.jsxs)(d.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Test Payload"}),(0,a.jsx)(v.T,{value:_,onChange:e=>F(e.target.value),className:"font-mono text-sm",rows:10})]}),P&&(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Test Results"}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:"Status:"}),(0,a.jsx)(c.E,{variant:P.success?"default":"destructive",children:P.success?"Success":"Failed"})]}),(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:"Valid Leads:"}),(0,a.jsx)("span",{children:P.validCount})]}),(0,a.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,a.jsx)("span",{className:"font-medium",children:"Errors:"}),(0,a.jsx)("span",{children:P.errorCount})]}),P.errors&&P.errors.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2 text-red-700",children:"Error Details:"}),(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded p-3 max-h-40 overflow-y-auto",children:(0,a.jsx)("ul",{className:"list-disc list-inside text-sm text-red-800 space-y-1",children:P.errors.map((e,s)=>(0,a.jsx)("li",{children:e},s))})})]}),P.processedLeads&&P.processedLeads.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2 text-green-700",children:"Successfully Processed Leads:"}),(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded p-3 max-h-40 overflow-y-auto",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-green-200",children:[(0,a.jsx)("thead",{className:"bg-green-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-green-700 uppercase",children:"Phone"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-green-700 uppercase",children:"Name"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-green-700 uppercase",children:"Email"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-green-700 uppercase",children:"Brand"}),(0,a.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-green-700 uppercase",children:"Source"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-green-200",children:P.processedLeads.map((e,s)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:e.phone}),(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:e.name||"-"}),(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:e.email||"-"}),(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:e.brand||"-"}),(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:e.source||"-"})]},s))})]})})})]}),A&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2 text-blue-700",children:"Field Mapping Validation:"}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded p-3",children:(0,a.jsx)("div",{className:"text-xs space-y-1",children:Object.entries(A.fieldMapping).map(e=>{let[s,t]=e,r=!1;try{let e=JSON.parse(_);r=!!(t&&void 0!==e[t])}catch(e){r=!1}return(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("span",{className:"text-blue-800",children:[s," ← ",t||"unmapped"]}),(0,a.jsx)(c.E,{variant:r?"default":"destructive",className:"text-xs",children:r?"Found":"Missing"})]},s)})})})]}),(0,a.jsxs)("details",{className:"mt-4",children:[(0,a.jsx)("summary",{className:"text-sm text-gray-500 cursor-pointer hover:text-gray-700",children:"View Raw Test Response"}),(0,a.jsx)("div",{className:"mt-2 bg-white border rounded p-3 text-xs font-mono max-h-40 overflow-y-auto",children:(0,a.jsx)("pre",{children:JSON.stringify(P,null,2)})})]})]})]})]}),(0,a.jsx)(d.wL,{children:(0,a.jsx)(n.$,{onClick:H,disabled:B,className:"ml-auto flex items-center gap-2",children:B?(0,a.jsx)(a.Fragment,{children:"Testing..."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Run Test"})]})})})]})}),(null===(t=A.conditionalRules)||void 0===t?void 0:t.enabled)&&(0,a.jsx)(o.av,{value:"rules",className:"space-y-4 pt-4",children:(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"Conditional Rules Configuration"}),(0,a.jsx)(d.BT,{children:"Advanced conditional logic and automated actions for this webhook."})]}),(0,a.jsxs)(d.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,a.jsx)("span",{className:"font-medium text-green-800",children:"Conditional Processing Enabled"})]}),(0,a.jsxs)(c.E,{variant:"outline",className:"bg-green-100 text-green-800",children:["Logic: ",A.conditionalRules.logicOperator]})]}),null===(u=A.conditionalRules.conditionSets)||void 0===u?void 0:u.map((e,s)=>{var t,r,i;return(0,a.jsxs)(d.Zp,{className:"border-l-4 border-l-blue-500",children:[(0,a.jsx)(d.aR,{className:"pb-3",children:(0,a.jsx)(d.ZB,{className:"text-lg",children:e.name})}),(0,a.jsxs)(d.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Conditions"}),(0,a.jsx)("div",{className:"space-y-2",children:null===(t=e.conditions)||void 0===t?void 0:t.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("code",{className:"bg-white px-2 py-1 rounded text-sm border",children:e.field}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e.operator.replace("_"," ")}),!["exists","not_exists","is_empty","is_not_empty"].includes(e.operator)&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("code",{className:"bg-white px-2 py-1 rounded text-sm border",children:"string"==typeof e.value?'"'.concat(e.value,'"'):String(e.value)})}),(0,a.jsx)(c.E,{variant:"outline",className:"text-xs",children:e.dataType})]},s))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:["Actions (",(null===(r=e.actions)||void 0===r?void 0:r.length)||0,")"]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:null===(i=e.actions)||void 0===i?void 0:i.map((e,s)=>(0,a.jsxs)("div",{className:"border rounded-lg p-3 ".concat("delete_lead"===e.type?"bg-red-50 border-red-200":"bg-blue-50"),children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,a.jsxs)(c.E,{variant:"delete_lead"===e.type?"destructive":"default",className:"text-xs",children:["delete_lead"===e.type&&"⚠️ ",e.type.replace("_"," ").toUpperCase()]})}),(0,a.jsx)("div",{className:"text-xs space-y-1 ".concat("delete_lead"===e.type?"text-red-700":"text-gray-600"),children:Object.entries(e.config||{}).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"font-medium",children:[s,":"]}),(0,a.jsx)("span",{className:"text-right max-w-32 truncate",title:String(t),children:String(t)})]},s)})})]},s))})]})]})]},s)}),(!A.conditionalRules.conditionSets||0===A.conditionalRules.conditionSets.length)&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)("p",{children:"No condition sets configured"}),(0,a.jsx)("p",{className:"text-sm",children:"Edit this webhook to add conditional rules"})]})]})]})})]})}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"Webhook not found"}),(0,a.jsx)(n.$,{variant:"outline",onClick:()=>w.push("/webhooks"),children:"Back to Webhooks"})]})]})})}},21773:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},29191:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]])},31666:(e,s,t)=>{Promise.resolve().then(t.bind(t,20411))},42640:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},52107:(e,s,t)=>{"use strict";t.d(s,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>l,aR:()=>n,wL:()=>x});var a=t(95155),r=t(12115),i=t(67910);let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});l.displayName="Card";let n=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t),...r})});n.displayName="CardHeader";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:s,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",t),...r})});d.displayName="CardTitle";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",t),...r})});c.displayName="CardDescription";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("p-6 pt-0",t),...r})});o.displayName="CardContent";let x=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",t),...r})});x.displayName="CardFooter"},60872:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]])},63669:(e,s,t)=>{"use strict";t.d(s,{Xi:()=>c,av:()=>o,j7:()=>d,tU:()=>n});var a=t(95155),r=t(12115),i=t(98217),l=t(67910);let n=i.bL,d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.B8,{ref:s,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...r})});d.displayName=i.B8.displayName;let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.l9,{ref:s,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...r})});c.displayName=i.l9.displayName;let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.UC,{ref:s,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r})});o.displayName=i.UC.displayName},67910:(e,s,t)=>{"use strict";t.d(s,{cn:()=>i});var a=t(43463),r=t(69795);function i(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.QP)((0,a.$)(s))}},76631:(e,s,t)=>{"use strict";t.d(s,{T:()=>l});var a=t(95155),r=t(12115),i=t(67910);let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...r})});l.displayName="Textarea"},97754:(e,s,t)=>{"use strict";t.d(s,{E:()=>n});var a=t(95155);t(12115);var r=t(31027),i=t(12558);let l=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:(0,i.cn)(l({variant:t}),s),...r})}}},e=>{var s=s=>e(e.s=s);e.O(0,[9272,2376,6514,5037,7295,8217,1169,8441,6587,7358],()=>s(31666)),_N_E=e.O()}]);