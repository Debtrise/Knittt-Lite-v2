(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4725],{10705:(e,s,t)=>{"use strict";t.d(s,{Cf:()=>x,Es:()=>m,L3:()=>h,c7:()=>u,lG:()=>d});var a=t(95155),r=t(12115),l=t(66217),i=t(40767),n=t(67910);let d=l.bL;l.l9;let c=l.ZL;l.bm;let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.hJ,{ref:s,className:(0,n.cn)("fixed inset-0 z-50 bg-black/50 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});o.displayName=l.hJ.displayName;let x=r.forwardRef((e,s)=>{let{className:t,children:r,...d}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(o,{}),(0,a.jsxs)(l.UC,{ref:s,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...d,children:[r,(0,a.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});x.displayName=l.UC.displayName;let u=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};u.displayName="DialogHeader";let m=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};m.displayName="DialogFooter";let h=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.hE,{ref:s,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",t),...r})});h.displayName=l.hE.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.VY,{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...r})}).displayName=l.VY.displayName},12558:(e,s,t)=>{"use strict";t.d(s,{cn:()=>l});var a=t(43463),r=t(69795);function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.QP)((0,a.$)(s))}},20853:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},21773:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},32906:(e,s,t)=>{"use strict";t.d(s,{S:()=>d});var a=t(95155),r=t(12115),l=t(86352),i=t(98867),n=t(67910);let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.bL,{ref:s,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...r,children:(0,a.jsx)(l.C1,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})})});d.displayName=l.bL.displayName},40887:(e,s,t)=>{Promise.resolve().then(t.bind(t,43156))},43031:(e,s,t)=>{"use strict";t.d(s,{p:()=>i});var a=t(95155),r=t(12115),l=t(12558);let i=r.forwardRef((e,s)=>{let{className:t,type:r,label:i,error:n,...d}=e;return(0,a.jsxs)("div",{className:"w-full",children:[i&&(0,a.jsx)("label",{htmlFor:d.id,className:"block text-sm font-medium text-gray-700 mb-1",children:i}),(0,a.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n?"border-red-500 focus-visible:ring-red-500":"",t),ref:s,...d}),n&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:n})]})});i.displayName="Input"},43156:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>w});var a=t(95155),r=t(12115),l=t(76046),i=t(48173),n=t.n(i),d=t(55037),c=t(87364);let o=(0,t(67401).A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var x=t(20853),u=t(40767),m=t(21773),h=t(1169),f=t(19393),p=t(97754),y=t(43031),g=t(32906),v=t(10705),j=t(63669),b=t(73746),N=t(85725);function w(e){let{params:s}=e;(0,l.useRouter)();let t=parseInt(s.id,10),{isAuthenticated:i}=(0,b.n)(),[w,k]=(0,r.useState)(null),[C,A]=(0,r.useState)([]),[E,S]=(0,r.useState)(!0),[L,$]=(0,r.useState)("active"),[z,F]=(0,r.useState)(""),[R,M]=(0,r.useState)([]),[P,U]=(0,r.useState)(!1),[X,_]=(0,r.useState)([]),[H,q]=(0,r.useState)(!1),[D,I]=(0,r.useState)(1),[J,V]=(0,r.useState)(1);(0,r.useEffect)(()=>{i&&t&&(O(),B())},[i,t,L,D]);let O=async()=>{try{let e=await (0,N.Hx)(t);k(e)}catch(e){console.error("Error fetching journey details:",e),d.Ay.error("Failed to load journey details")}},B=async()=>{try{S(!0);let e=await (0,N.MF)(t,{status:"all"!==L?L:void 0,page:D,limit:10});A(e.leads||[]),V(e.totalPages||1)}catch(e){console.error("Error fetching journey leads:",e),d.Ay.error("Failed to load journey leads")}finally{S(!1)}},G=async()=>{try{let e=await (0,N.ah)({limit:100});_(e.leads||[])}catch(e){console.error("Error fetching available leads:",e),d.Ay.error("Failed to load available leads")}},T=()=>{I(1),B()},Y=async e=>{try{q(!0),await (0,N.n3)(t,{leadIds:e}),d.Ay.success("Leads enrolled successfully"),U(!1),B()}catch(e){console.error("Error enrolling leads:",e),d.Ay.error("Failed to enroll leads")}finally{q(!1)}},K=async(e,s)=>{try{await (0,N.iE)(e,t,{status:s}),d.Ay.success("Lead status updated to ".concat(s)),B()}catch(e){console.error("Error updating lead status:",e),d.Ay.error("Failed to update lead status")}},Q=async e=>{if(0===R.length){d.Ay.error("No leads selected");return}try{for(let s of(S(!0),R))await (0,N.iE)(s,t,{status:e});d.Ay.success("Updated ".concat(R.length," leads to ").concat(e)),M([]),B()}catch(e){console.error("Error performing bulk action:",e),d.Ay.error("Failed to update some leads")}finally{S(!1)}},Z=e=>{R.includes(e)?M(R.filter(s=>s!==e)):M([...R,e])};return i?(0,a.jsxs)(h.A,{children:[(0,a.jsxs)("div",{className:"py-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(n(),{href:"/journeys/".concat(t),children:(0,a.jsx)(f.$,{variant:"ghost",className:"mr-4",children:(0,a.jsx)(c.A,{className:"h-5 w-5"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:w?"".concat(w.name," - Leads"):"Journey Leads"}),w&&(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Manage leads enrolled in this journey"})]})]}),(0,a.jsxs)(f.$,{onClick:()=>{G(),U(!0)},children:[(0,a.jsx)(o,{className:"h-4 w-4 mr-2"}),"Enroll Leads"]})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(j.tU,{value:L,onValueChange:$,className:"w-full",children:(0,a.jsxs)(j.j7,{children:[(0,a.jsx)(j.Xi,{value:"active",children:"Active"}),(0,a.jsx)(j.Xi,{value:"paused",children:"Paused"}),(0,a.jsx)(j.Xi,{value:"completed",children:"Completed"}),(0,a.jsx)(j.Xi,{value:"failed",children:"Failed"}),(0,a.jsx)(j.Xi,{value:"exited",children:"Exited"}),(0,a.jsx)(j.Xi,{value:"all",children:"All"})]})}),(0,a.jsxs)("div",{className:"flex items-center ml-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(y.p,{type:"text",placeholder:"Search leads...",value:z,onChange:e=>F(e.target.value),onKeyDown:e=>"Enter"===e.key&&T(),className:"pl-10"}),(0,a.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:(0,a.jsx)(x.A,{className:"h-4 w-4 text-gray-400"})}),z&&(0,a.jsx)("button",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",onClick:()=>{F(""),T()},children:(0,a.jsx)(u.A,{className:"h-4 w-4 text-gray-400"})})]}),(0,a.jsx)(f.$,{variant:"ghost",size:"icon",onClick:B,title:"Refresh",className:"ml-2",children:(0,a.jsx)(m.A,{className:"h-4 w-4"})})]})]})}),R.length>0&&(0,a.jsxs)("div",{className:"p-4 bg-gray-50 border-b border-gray-200 flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[R.length," lead",R.length>1?"s":""," selected"]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(f.$,{variant:"outline",size:"sm",onClick:()=>Q("paused"),disabled:E,children:"Pause"}),(0,a.jsx)(f.$,{variant:"outline",size:"sm",onClick:()=>Q("active"),disabled:E,children:"Activate"}),(0,a.jsx)(f.$,{variant:"outline",size:"sm",onClick:()=>Q("exited"),disabled:E,children:"Exit"}),(0,a.jsx)(f.$,{variant:"ghost",size:"sm",onClick:()=>M([]),children:"Clear Selection"})]})]}),E?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand"})}):0===C.length?(0,a.jsxs)("div",{className:"p-6 text-center",children:[(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"No leads found in this journey"}),(0,a.jsxs)(f.$,{onClick:()=>{G(),U(!0)},children:[(0,a.jsx)(o,{className:"h-4 w-4 mr-2"}),"Enroll Leads"]})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"pl-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-10",children:(0,a.jsx)(g.S,{checked:R.length===C.length,onCheckedChange:e=>{e?M(C.map(e=>e.id)):M([])},"aria-label":"Select all leads"})}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lead"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Current Step"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Next Execution"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(e=>{var s;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"pl-6 py-4 whitespace-nowrap",children:(0,a.jsx)(g.S,{checked:R.includes(e.id),onCheckedChange:()=>Z(e.id),"aria-label":"Select lead ".concat(e.id)})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.Lead?(0,a.jsx)(n(),{href:"/leads/".concat(e.leadId),className:"hover:underline",children:e.Lead.name}):"Lead #".concat(e.leadId)}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:null===(s=e.Lead)||void 0===s?void 0:s.phone})]})})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)(p.E,{variant:"active"===e.status?"default":"paused"===e.status?"secondary":"completed"===e.status?"outline":"destructive",children:e.status})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.currentStep?e.currentStep.name:"N/A"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.nextExecutionTime?new Date(e.nextExecutionTime).toLocaleString():"Not scheduled"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:["active"===e.status?(0,a.jsx)(f.$,{variant:"ghost",size:"sm",onClick:()=>K(e.id,"paused"),children:"Pause"}):"paused"===e.status?(0,a.jsx)(f.$,{variant:"ghost",size:"sm",onClick:()=>K(e.id,"active"),children:"Activate"}):null,(0,a.jsx)(f.$,{variant:"ghost",size:"sm",onClick:()=>K(e.id,"exited"),children:"Exit"})]})})]},e.id)})})]})}),J>1&&(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[(0,a.jsx)(f.$,{variant:"outline",size:"sm",onClick:()=>I(e=>Math.max(e-1,1)),disabled:1===D,children:"Previous"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Page ",D," of ",J]}),(0,a.jsx)(f.$,{variant:"outline",size:"sm",onClick:()=>I(e=>Math.min(e+1,J)),disabled:D===J,children:"Next"})]})]})]}),(0,a.jsx)(v.lG,{open:P,onOpenChange:U,children:(0,a.jsxs)(v.Cf,{className:"sm:max-w-md",children:[(0,a.jsx)(v.c7,{children:(0,a.jsx)(v.L3,{children:"Enroll Leads in Journey"})}),(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"Select leads to enroll in this journey"}),(0,a.jsx)(y.p,{type:"text",placeholder:"Search leads...",className:"mb-2",onChange:e=>{let s=e.target.value.toLowerCase();""===s?G():_(e=>e.filter(e=>{var t,a,r;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(s))||(null===(a=e.phone)||void 0===a?void 0:a.includes(s))||(null===(r=e.email)||void 0===r?void 0:r.toLowerCase().includes(s))}))}})]}),(0,a.jsx)("div",{className:"max-h-60 overflow-y-auto border rounded-md",children:0===X.length?(0,a.jsx)("div",{className:"p-4 text-center text-gray-500",children:"No leads found"}):(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:X.map(e=>(0,a.jsxs)("div",{className:"p-3 flex items-center",children:[(0,a.jsx)(g.S,{id:"lead-".concat(e.id),checked:R.includes(e.id),onCheckedChange:s=>{s?M(s=>[...s,e.id]):M(s=>s.filter(s=>s!==e.id))},className:"mr-2"}),(0,a.jsxs)("label",{htmlFor:"lead-".concat(e.id),className:"flex-1 text-sm cursor-pointer",children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsxs)("div",{className:"text-gray-500 text-xs",children:[e.phone," ",e.email?"• ".concat(e.email):""]})]})]},e.id))})})]}),(0,a.jsxs)(v.Es,{children:[(0,a.jsx)(f.$,{variant:"outline",onClick:()=>U(!1),children:"Cancel"}),(0,a.jsx)(f.$,{onClick:()=>Y(R),disabled:0===R.length||H,children:H?"Enrolling...":"Enroll Selected Leads"})]})]})})]}):null}},63669:(e,s,t)=>{"use strict";t.d(s,{Xi:()=>c,av:()=>o,j7:()=>d,tU:()=>n});var a=t(95155),r=t(12115),l=t(98217),i=t(67910);let n=l.bL,d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.B8,{ref:s,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...r})});d.displayName=l.B8.displayName;let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.l9,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...r})});c.displayName=l.l9.displayName;let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.UC,{ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r})});o.displayName=l.UC.displayName},87364:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},97754:(e,s,t)=>{"use strict";t.d(s,{E:()=>n});var a=t(95155);t(12115);var r=t(31027),l=t(12558);let i=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:(0,l.cn)(i({variant:t}),s),...r})}}},e=>{var s=s=>e(e.s=s);e.O(0,[9272,2376,6514,5037,7295,6870,8217,8822,1169,1485,8441,6587,7358],()=>s(40887)),_N_E=e.O()}]);