(()=>{var e={};e.id=5221,e.ids=[5221],e.modules={1372:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(41680).A)("message-square",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4339:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(41680).A)("play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]])},4643:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(41680).A)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},12417:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>v});var r=t(45512),a=t(58009),i=t(79334),n=t(22403),l=t(35668),d=t(81259),o=t(4339),c=t(4643),m=t(61594),p=t(72744),x=t(24849),u=t(1372),h=t(13868),g=t(43517),y=t(66581),f=t(92666);function v(){let e=(0,i.useParams)(),s=(0,i.useRouter)(),{isAuthenticated:t}=(0,f.n)(),[v,j]=(0,a.useState)(null),[b,N]=(0,a.useState)(!0),[w,A]=(0,a.useState)(!1),[C,k]=(0,a.useState)(null),P=(0,a.useRef)(null),q=parseInt(e.id,10),_=async()=>{N(!0);try{let e=await (0,y.mI)(q);j(e)}catch(e){console.error("Error fetching campaign details:",e),n.Ay.error("Failed to load campaign details")}finally{N(!1)}},z=async()=>{try{let e=await (0,y.Kl)(q);e?j(e):_(),n.Ay.success("Campaign started")}catch(e){console.error("Error starting campaign:",e),n.Ay.error("Failed to start campaign")}},S=async()=>{try{let e=await (0,y.kb)(q);e?j(e):_(),n.Ay.success("Campaign paused")}catch(e){console.error("Error pausing campaign:",e),n.Ay.error("Failed to pause campaign")}},E=async()=>{if(!v)return;let e=prompt("Enter new rate limit (messages per hour):",v.rateLimit.toString());if(!e)return;let s=parseInt(e,10);if(isNaN(s)||s<=0){n.Ay.error("Please enter a valid number greater than 0");return}try{let e=await (0,y.Ah)(q,s);e?j(e):_(),n.Ay.success("Rate limit updated successfully")}catch(e){console.error("Error updating rate limit:",e),n.Ay.error("Failed to update rate limit")}},M=async e=>{if(!e.target.files||0===e.target.files.length)return;let s=e.target.files[0];if("text/csv"!==s.type&&!s.name.endsWith(".csv")){n.Ay.error("Please select a CSV file");return}let t=new FormData;t.append("contacts",s),A(!0);try{let e=await (0,y.Aq)(q,t);e&&e.campaign?(j(e.campaign),n.Ay.success(e.message||"Contacts uploaded successfully")):(_(),n.Ay.success("Contacts uploaded successfully")),P.current&&(P.current.value="")}catch(e){console.error("Error uploading contacts:",e),n.Ay.error("Failed to upload contacts")}finally{A(!1)}},F=e=>new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),L=()=>v&&0!==v.totalContacts?Math.round(v.sentCount/v.totalContacts*100):0;return t?(0,r.jsx)(h.A,{children:(0,r.jsxs)("div",{className:"py-6",children:[(0,r.jsxs)("div",{className:"flex items-center mb-6",children:[(0,r.jsx)(g.$,{variant:"ghost",onClick:()=>s.push("/sms"),className:"mr-4",children:(0,r.jsx)(l.A,{className:"h-5 w-5"})}),(0,r.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"SMS Campaign Details"})]}),b?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand"})}):v?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg mb-6",children:[(0,r.jsxs)("div",{className:"px-4 py-5 sm:px-6 flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:v.name}),(0,r.jsxs)("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:["Created: ",F(v.createdAt)," â€¢ Last Updated: ",F(v.updatedAt)]})]}),(0,r.jsx)("div",{className:"flex space-x-2",children:"active"===v.status?(0,r.jsxs)(g.$,{variant:"secondary",onClick:S,children:[(0,r.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Pause Campaign"]}):"completed"!==v.status&&(0,r.jsxs)(g.$,{variant:"brand",onClick:z,disabled:0===v.totalContacts,children:[(0,r.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"Start Campaign"]})})]}),(0,r.jsx)("div",{className:"border-t border-gray-200",children:(0,r.jsxs)("dl",{children:[(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Status"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:(0,r.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium 
                        ${"active"===v.status?"bg-green-100 text-green-800":"paused"===v.status?"bg-yellow-100 text-yellow-800":"completed"===v.status?"bg-gray-100 text-gray-800":"bg-blue-100 text-blue-800"}`,children:v.status.charAt(0).toUpperCase()+v.status.slice(1)})})]}),(0,r.jsxs)("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Message Template"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2 font-mono bg-gray-50 p-3 rounded",children:v.messageTemplate})]}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Rate Limit"}),(0,r.jsxs)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2 flex items-center",children:[(0,r.jsxs)("span",{children:[v.rateLimit," messages per hour"]}),(0,r.jsx)(g.$,{variant:"ghost",size:"sm",onClick:E,className:"ml-2",children:(0,r.jsx)(c.A,{className:"h-4 w-4"})})]})]}),(0,r.jsxs)("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Progress"}),(0,r.jsxs)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,r.jsx)("div",{children:(0,r.jsxs)("span",{className:"text-sm font-medium text-brand",children:[v.sentCount," of ",v.totalContacts," messages sent"]})}),(0,r.jsx)("div",{className:"text-right",children:(0,r.jsxs)("span",{className:"text-sm font-semibold inline-block text-brand",children:[L(),"%"]})})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,r.jsx)("div",{className:"bg-brand h-2.5 rounded-full",style:{width:`${L()}%`}})}),v.failedCount>0&&(0,r.jsxs)("div",{className:"flex items-center mt-2 text-red-600",children:[(0,r.jsx)(m.A,{className:"h-4 w-4 mr-1"}),(0,r.jsxs)("span",{className:"text-sm",children:[v.failedCount," messages failed to send"]})]})]})]})]})})]}),(0,r.jsxs)("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[(0,r.jsxs)("div",{className:"px-4 py-5 sm:px-6",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Upload Contacts"}),(0,r.jsx)("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Upload a CSV file with contacts for this campaign."})]}),(0,r.jsxs)("div",{className:"border-t border-gray-200 px-4 py-5 sm:p-6",children:[(0,r.jsxs)("div",{className:"sm:flex sm:items-start sm:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm text-gray-500 mb-3",children:["The CSV file must have a ",(0,r.jsx)("code",{className:"font-mono text-xs bg-gray-100 px-1 py-0.5 rounded",children:"phone"})," column. Other recognized columns are ",(0,r.jsx)("code",{className:"font-mono text-xs bg-gray-100 px-1 py-0.5 rounded",children:"name"})," and ",(0,r.jsx)("code",{className:"font-mono text-xs bg-gray-100 px-1 py-0.5 rounded",children:"email"}),". Any additional columns will be available as custom fields in your message template."]}),(0,r.jsxs)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Example CSV format:"}),(0,r.jsx)("pre",{className:"mt-1 text-xs text-gray-600",children:"phone,name,email,custom_field1,custom_field2 +12345678901,John Doe,john@example.com,value1,value2"})]})]}),(0,r.jsx)("div",{className:"mt-5 sm:mt-0 sm:ml-6 sm:flex-shrink-0 sm:flex sm:items-center",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{ref:P,type:"file",accept:".csv",id:"file-upload",className:"hidden",onChange:M}),(0,r.jsx)("label",{htmlFor:"file-upload",className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white ${w?"bg-gray-400 cursor-not-allowed":"bg-brand hover:bg-brand-dark cursor-pointer"}`,children:w?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin mr-2 h-4 w-4 text-white",children:(0,r.jsxs)("svg",{className:"h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),"Uploading..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Upload Contacts"]})})]})})]}),v.totalContacts>0&&(0,r.jsxs)("div",{className:"mt-4 flex items-center text-sm text-green-600",children:[(0,r.jsx)(x.A,{className:"h-5 w-5 mr-1"}),(0,r.jsxs)("span",{children:[v.totalContacts," contacts loaded"]})]})]})]})]}):(0,r.jsx)("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:(0,r.jsxs)("div",{className:"px-4 py-12 text-center sm:px-6",children:[(0,r.jsx)(u.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Campaign not found"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"The requested campaign may have been deleted or doesn't exist."}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsxs)(g.$,{variant:"brand",onClick:()=>s.push("/sms"),children:[(0,r.jsx)(l.A,{className:"mr-2 h-4 w-4"}),"Back to Campaigns"]})})]})})]})}):null}},14731:(e,s,t)=>{Promise.resolve().then(t.bind(t,53925))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:e=>{"use strict";e.exports=require("os")},24849:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(41680).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},35668:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(41680).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},53925:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Applications/Knittt-Lite-v2/app/(app)/sms/[id]/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Applications/Knittt-Lite-v2/app/(app)/sms/[id]/page.tsx","default")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},72744:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(41680).A)("upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},74075:e=>{"use strict";e.exports=require("zlib")},74403:(e,s,t)=>{Promise.resolve().then(t.bind(t,12417))},75097:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>p,tree:()=>o});var r=t(70260),a=t(28203),i=t(25155),n=t.n(i),l=t(67292),d={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let o={children:["",{children:["(app)",{children:["sms",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,53925)),"/Applications/Knittt-Lite-v2/app/(app)/sms/[id]/page.tsx"]}]},{}]},{}]},{"not-found":[()=>Promise.resolve().then(t.t.bind(t,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,19611)),"/Applications/Knittt-Lite-v2/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Applications/Knittt-Lite-v2/app/(app)/sms/[id]/page.tsx"],m={require:t,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(app)/sms/[id]/page",pathname:"/sms/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},79551:e=>{"use strict";e.exports=require("url")},81259:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(41680).A)("pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]])},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},94735:e=>{"use strict";e.exports=require("events")}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[638,1057,4052,5668,7519,6572,9388,931,3868,9110],()=>t(75097));module.exports=r})();