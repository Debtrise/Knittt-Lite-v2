"use strict";exports.id=2219,exports.ids=[2219],exports.modules={2112:(e,a,l)=>{l.d(a,{C1:()=>w,bL:()=>j});var s=l(58009),t=l(29952),n=l(6004),r=l(31412),i=l(13024),d=l(66582),o=l(38762),c=l(98060),u=l(30830),p=l(45512),m="Checkbox",[h,x]=(0,n.A)(m),[b,f]=h(m);function y(e){let{__scopeCheckbox:a,checked:l,children:t,defaultChecked:n,disabled:r,form:d,name:o,onCheckedChange:c,required:u,value:h="on",internal_do_not_use_render:x}=e,[f,y]=(0,i.i)({prop:l,defaultProp:n??!1,onChange:c,caller:m}),[v,g]=s.useState(null),[j,N]=s.useState(null),w=s.useRef(!1),k=!v||!!d||!!v.closest("form"),C={checked:f,disabled:r,setChecked:y,control:v,setControl:g,name:o,form:d,value:h,hasConsumerStoppedPropagationRef:w,required:u,defaultChecked:!R(n)&&n,isFormControl:k,bubbleInput:j,setBubbleInput:N};return(0,p.jsx)(b,{scope:a,...C,children:"function"==typeof x?x(C):t})}var v="CheckboxTrigger",g=s.forwardRef(({__scopeCheckbox:e,onKeyDown:a,onClick:l,...n},i)=>{let{control:d,value:o,disabled:c,checked:m,required:h,setControl:x,setChecked:b,hasConsumerStoppedPropagationRef:y,isFormControl:g,bubbleInput:j}=f(v,e),N=(0,t.s)(i,x),w=s.useRef(m);return s.useEffect(()=>{let e=d?.form;if(e){let a=()=>b(w.current);return e.addEventListener("reset",a),()=>e.removeEventListener("reset",a)}},[d,b]),(0,p.jsx)(u.sG.button,{type:"button",role:"checkbox","aria-checked":R(m)?"mixed":m,"aria-required":h,"data-state":S(m),"data-disabled":c?"":void 0,disabled:c,value:o,...n,ref:N,onKeyDown:(0,r.m)(a,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,r.m)(l,e=>{b(e=>!!R(e)||!e),j&&g&&(y.current=e.isPropagationStopped(),y.current||e.stopPropagation())})})});g.displayName=v;var j=s.forwardRef((e,a)=>{let{__scopeCheckbox:l,name:s,checked:t,defaultChecked:n,required:r,disabled:i,value:d,onCheckedChange:o,form:c,...u}=e;return(0,p.jsx)(y,{__scopeCheckbox:l,checked:t,defaultChecked:n,disabled:i,required:r,onCheckedChange:o,name:s,form:c,value:d,internal_do_not_use_render:({isFormControl:e})=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(g,{...u,ref:a,__scopeCheckbox:l}),e&&(0,p.jsx)(C,{__scopeCheckbox:l})]})})});j.displayName=m;var N="CheckboxIndicator",w=s.forwardRef((e,a)=>{let{__scopeCheckbox:l,forceMount:s,...t}=e,n=f(N,l);return(0,p.jsx)(c.C,{present:s||R(n.checked)||!0===n.checked,children:(0,p.jsx)(u.sG.span,{"data-state":S(n.checked),"data-disabled":n.disabled?"":void 0,...t,ref:a,style:{pointerEvents:"none",...e.style}})})});w.displayName=N;var k="CheckboxBubbleInput",C=s.forwardRef(({__scopeCheckbox:e,...a},l)=>{let{control:n,hasConsumerStoppedPropagationRef:r,checked:i,defaultChecked:c,required:m,disabled:h,name:x,value:b,form:y,bubbleInput:v,setBubbleInput:g}=f(k,e),j=(0,t.s)(l,g),N=(0,d.Z)(i),w=(0,o.X)(n);s.useEffect(()=>{if(!v)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,a=!r.current;if(N!==i&&e){let l=new Event("click",{bubbles:a});v.indeterminate=R(i),e.call(v,!R(i)&&i),v.dispatchEvent(l)}},[v,N,i,r]);let C=s.useRef(!R(i)&&i);return(0,p.jsx)(u.sG.input,{type:"checkbox","aria-hidden":!0,defaultChecked:c??C.current,required:m,disabled:h,name:x,value:b,form:y,...a,tabIndex:-1,ref:j,style:{...a.style,...w,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function R(e){return"indeterminate"===e}function S(e){return R(e)?"indeterminate":e?"checked":"unchecked"}C.displayName=k},7702:(e,a,l)=>{l.d(a,{cn:()=>n});var s=l(82281),t=l(94805);function n(...e){return(0,t.QP)((0,s.$)(e))}},34705:(e,a,l)=>{l.d(a,{J:()=>d});var s=l(45512),t=l(58009),n=l(30830),r=t.forwardRef((e,a)=>(0,s.jsx)(n.sG.label,{...e,ref:a,onMouseDown:a=>{a.target.closest("button, input, select, textarea")||(e.onMouseDown?.(a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));r.displayName="Label";var i=l(89808);let d=t.forwardRef(({className:e,...a},l)=>(0,s.jsx)(r,{ref:l,className:(0,i.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...a}));d.displayName=r.displayName},43517:(e,a,l)=>{l.d(a,{$:()=>d});var s=l(45512),t=l(58009),n=l(21643),r=l(89808);let i=(0,n.F)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",brand:"bg-brand text-white hover:bg-brand/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=t.forwardRef(({className:e,variant:a,size:l,asChild:t=!1,isLoading:n,children:d,disabled:o,...c},u)=>(0,s.jsx)("button",{className:(0,r.cn)(i({variant:a,size:l,className:e})),ref:u,disabled:o||n,...c,children:n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),d]}):d}));d.displayName="Button"},49169:(e,a,l)=>{l.d(a,{p:()=>r});var s=l(45512),t=l(58009),n=l(7702);let r=t.forwardRef(({className:e,type:a,label:l,error:t,...r},i)=>(0,s.jsxs)("div",{className:"w-full",children:[l&&(0,s.jsx)("label",{htmlFor:r.id,className:"block text-sm font-medium text-gray-700 mb-1",children:l}),(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t?"border-red-500 focus-visible:ring-red-500":"",e),ref:i,...r}),t&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:t})]}));r.displayName="Input"},52219:(e,a,l)=>{l.d(a,{A:()=>h});var s=l(45512),t=l(58009),n=l(79334),r=l(43517),i=l(49169),d=l(34705),o=l(59010),c=l(75749),u=l(63451),p=l(67679),m=l(22403);function h({webhookId:e,isEdit:a=!1,onSuccess:l}){let h=(0,n.useRouter)(),[x,b]=(0,t.useState)(a),[f,y]=(0,t.useState)(!1),[v,g]=(0,t.useState)([]),[j,N]=(0,t.useState)([]),[w,k]=(0,t.useState)({name:"",description:"",brand:"",source:"",fieldMapping:{phone:"phone",name:"full_name",email:"email_address"},validationRules:{requirePhone:!0,requireName:!1,requireEmail:!1,allowDuplicatePhone:!1},autoTagRules:[{field:"source",operator:"equals",value:"website",tag:"web-lead"}]}),[C,R]=(0,t.useState)([{key:"phone",value:"phone"},{key:"name",value:"full_name"},{key:"email",value:"email_address"}]),[S,T]=(0,t.useState)([]),[_,A]=(0,t.useState)([{field:"source",operator:"equals",value:"website",tag:"web-lead"}]),[q,E]=(0,t.useState)([]),[P,D]=(0,t.useState)({enabled:!1,logicOperator:"AND",conditionSets:[]}),I=[{value:"equals",label:"Equals",dataTypes:["string","number","boolean"]},{value:"not_equals",label:"Not Equals",dataTypes:["string","number","boolean"]},{value:"contains",label:"Contains",dataTypes:["string","array"]},{value:"not_contains",label:"Not Contains",dataTypes:["string","array"]},{value:"starts_with",label:"Starts With",dataTypes:["string"]},{value:"ends_with",label:"Ends With",dataTypes:["string"]},{value:"greater_than",label:"Greater Than",dataTypes:["number","date"]},{value:"less_than",label:"Less Than",dataTypes:["number","date"]},{value:"greater_than_or_equal",label:"Greater Than or Equal",dataTypes:["number","date"]},{value:"less_than_or_equal",label:"Less Than or Equal",dataTypes:["number","date"]},{value:"exists",label:"Exists",dataTypes:["string","number","boolean","array"]},{value:"not_exists",label:"Not Exists",dataTypes:["string","number","boolean","array"]},{value:"is_empty",label:"Is Empty",dataTypes:["string","array"]},{value:"is_not_empty",label:"Is Not Empty",dataTypes:["string","array"]},{value:"regex_match",label:"Regex Match",dataTypes:["string"]}],M=[{value:"create_lead",label:"Create Lead",description:"Create a new lead with custom field mapping"},{value:"update_lead",label:"Update Lead",description:"Update existing leads based on search criteria"},{value:"delete_lead",label:"Delete Lead",description:"Delete existing leads based on search criteria"},{value:"send_notification",label:"Send Notification",description:"Send email/SMS notifications"},{value:"enroll_journey",label:"Enroll Journey",description:"Auto-enroll leads in journeys"},{value:"call_webhook",label:"Call Webhook",description:"Call external webhooks"},{value:"set_tags",label:"Set Tags",description:"Add/remove tags from leads"},{value:"create_task",label:"Create Task",description:"Create tasks and reminders"}],F=async()=>{if(e)try{let a=await p.Ay.webhooks.getEvents(e.toString(),{page:1,limit:10}),l=a.data||a,s=l.events||l||[],t=new Set;s.forEach(e=>{e.payload&&"object"==typeof e.payload&&O(e.payload,"",t)});let n=Array.from(t).sort();console.log("Extracted webhook fields:",n),N(n)}catch(e){console.error("Error fetching webhook events:",e)}},O=(e,a,l)=>{Object.keys(e).forEach(s=>{let t=a?`${a}.${s}`:s;l.add(t),e[s]&&"object"==typeof e[s]&&!Array.isArray(e[s])&&O(e[s],t,l)})},J=e=>{let{name:a,value:l}=e.target;k(e=>({...e,[a]:l}))},L=(e,a)=>{k(l=>({...l,validationRules:{...l.validationRules,[e]:a}}))},U=(e,a,l)=>{let s=[...C];""!==a&&(s[e]={key:a,value:l}),R(s);let t=s.reduce((e,{key:a,value:l})=>(a&&(e[a]=l),e),{}),n=S.reduce((e,{key:a,value:l})=>(a&&(e[a]=l),e),{});k(e=>({...e,fieldMapping:{...t,...n}}))},$=(e,a,l)=>{let s=[...S];s[e]={key:a,value:l},T(s);let t=C.reduce((e,{key:a,value:l})=>(a&&(e[a]=l),e),{}),n=s.reduce((e,{key:a,value:l})=>(a&&(e[a]=l),e),{});k(e=>({...e,fieldMapping:{...t,...n}}))},W=e=>{let a=[...S];a.splice(e,1),T(a);let l=C.reduce((e,{key:a,value:l})=>(a&&(e[a]=l),e),{}),s=a.reduce((e,{key:a,value:l})=>(a&&(e[a]=l),e),{});k(e=>({...e,fieldMapping:{...l,...s}}))},B=(e,a,l)=>{let s=[..._];s[e]={...s[e],[a]:l},A(s),k(e=>({...e,autoTagRules:s}))},z=e=>{let a=[..._];a.splice(e,1),A(a),k(e=>({...e,autoTagRules:a}))},V=(e,a,l)=>{let s=[...q];s[e]={key:a,value:l},E(s);let t=s.reduce((e,{key:a,value:l})=>(a&&(e[a]=l),e),{});k(e=>({...e,requiredHeaders:t}))},Z=e=>{let a=[...q];a.splice(e,1),E(a);let l=a.reduce((e,{key:a,value:l})=>(a&&(e[a]=l),e),{});k(e=>({...e,requiredHeaders:l}))},H=async a=>{if(a.preventDefault(),G()){y(!0);try{let a;let s={...w,autoEnrollJourneyId:""===w.autoEnrollJourneyId?null:w.autoEnrollJourneyId,conditionalRules:P.enabled?P:null};e?(a=await p.Ay.webhooks.update(e,s),m.oR.success("Webhook updated successfully")):(a=await p.Ay.webhooks.create(s),m.oR.success("Webhook created successfully")),l&&l(a.data||a)}catch(e){console.error("Error saving webhook:",e),m.oR.error(e.response?.data?.error||"Failed to save webhook")}finally{y(!1)}}},G=()=>!0,X=e=>{D(a=>({...a,conditionSets:a.conditionSets.filter((a,l)=>l!==e)}))},Q=(e,a,l)=>{D(s=>({...s,conditionSets:s.conditionSets.map((s,t)=>t===e?{...s,[a]:l}:s)}))},K=e=>{D(a=>({...a,conditionSets:a.conditionSets.map((a,l)=>l===e?{...a,conditions:[...a.conditions,{field:"",operator:"equals",value:"",dataType:"string"}]}:a)}))},Y=(e,a)=>{D(l=>({...l,conditionSets:l.conditionSets.map((l,s)=>s===e?{...l,conditions:l.conditions.filter((e,l)=>l!==a)}:l)}))},ee=(e,a,l,s)=>{D(t=>({...t,conditionSets:t.conditionSets.map((t,n)=>n===e?{...t,conditions:t.conditions.map((e,t)=>t===a?{...e,[l]:s}:e)}:t)}))},ea=e=>{D(a=>({...a,conditionSets:a.conditionSets.map((a,l)=>l===e?{...a,actions:[...a.actions,{type:"create_lead",config:{}}]}:a)}))},el=(e,a)=>{D(l=>({...l,conditionSets:l.conditionSets.map((l,s)=>s===e?{...l,actions:l.actions.filter((e,l)=>l!==a)}:l)}))},es=(e,a,l,s)=>{D(t=>({...t,conditionSets:t.conditionSets.map((t,n)=>n===e?{...t,actions:t.actions.map((e,t)=>t===a?"type"===l?{type:s,config:{}}:{...e,[l]:s}:e)}:t)}))},et=e=>{switch(e){case"create_lead":return[{key:"brand",label:"Brand",type:"text",placeholder:"Override brand"},{key:"source",label:"Source",type:"text",placeholder:"Override source"}];case"update_lead":return[{key:"searchField",label:"Search Field",type:"select",options:[{value:"phone",label:"Phone Number"},{value:"email",label:"Email Address"},{value:"id",label:"Lead ID"}]},{key:"searchValue",label:"Search Value",type:"text",placeholder:"Use {{field}} for dynamic values"},{key:"updateFields",label:"Update Fields",type:"textarea",placeholder:'{"status": "updated", "notes": "Updated via webhook"}'}];case"delete_lead":return[{key:"searchField",label:"Search Field",type:"select",options:[{value:"phone",label:"Phone Number"},{value:"email",label:"Email Address"},{value:"id",label:"Lead ID"},{value:"brand",label:"Brand"},{value:"source",label:"Source"}]},{key:"searchValue",label:"Search Value",type:"text",placeholder:"Use {{field}} for dynamic values from webhook"},{key:"confirmationRequired",label:"Require Confirmation",type:"select",options:[{value:"false",label:"Delete Immediately"},{value:"true",label:"Mark for Deletion (Requires Manual Confirmation)"}]},{key:"reason",label:"Deletion Reason",type:"text",placeholder:"Unsubscribed via webhook"}];case"enroll_journey":return[{key:"journeyId",label:"Journey",type:"select",options:v.map(e=>({value:e.id,label:e.name}))},{key:"priority",label:"Priority",type:"select",options:[{value:"low",label:"Low"},{value:"normal",label:"Normal"},{value:"high",label:"High"},{value:"immediate",label:"Immediate"}]}];case"send_notification":return[{key:"recipients",label:"Recipients",type:"text",placeholder:"email1@example.com,email2@example.com"},{key:"subject",label:"Subject",type:"text",placeholder:"New lead: {{name}}"},{key:"message",label:"Message",type:"textarea",placeholder:"New lead received: {{name}} ({{phone}})"},{key:"type",label:"Type",type:"select",options:[{value:"email",label:"Email"},{value:"sms",label:"SMS"}]}];case"set_tags":return[{key:"operation",label:"Operation",type:"select",options:[{value:"add",label:"Add Tags"},{value:"remove",label:"Remove Tags"}]},{key:"tags",label:"Tags",type:"text",placeholder:"tag1,tag2,tag3"}];case"call_webhook":return[{key:"url",label:"Webhook URL",type:"text",placeholder:"https://api.example.com/webhook"},{key:"method",label:"Method",type:"select",options:[{value:"POST",label:"POST"},{value:"PUT",label:"PUT"},{value:"PATCH",label:"PATCH"}]},{key:"headers",label:"Headers",type:"textarea",placeholder:'{"Authorization": "Bearer token"}'}];case"create_task":return[{key:"title",label:"Task Title",type:"text",placeholder:"Follow up with {{name}}"},{key:"description",label:"Description",type:"textarea",placeholder:"Contact lead about {{subject}}"},{key:"dueDate",label:"Due Date",type:"text",placeholder:"+1d (1 day from now)"},{key:"assignee",label:"Assignee",type:"text",placeholder:"user@example.com"}];default:return[]}};return x?(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("p",{children:"Loading webhook data..."})}):(0,s.jsxs)("form",{onSubmit:H,className:"space-y-6",children:[(0,s.jsxs)(u.Zp,{children:[(0,s.jsxs)(u.aR,{children:[(0,s.jsx)(u.ZB,{children:"Basic Information"}),(0,s.jsx)(u.BT,{children:"Enter the basic details for your webhook endpoint."})]}),(0,s.jsx)(u.Wu,{className:"space-y-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"name",children:"Name *"}),(0,s.jsx)(i.p,{id:"name",name:"name",value:w.name,onChange:J,placeholder:"CRM Integration",required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"description",children:"Description"}),(0,s.jsx)(i.p,{id:"description",name:"description",value:w.description,onChange:J,placeholder:"Receives leads from our CRM system"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"brand",children:"Brand *"}),(0,s.jsx)(i.p,{id:"brand",name:"brand",value:w.brand,onChange:J,placeholder:"Tax Relief",required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"source",children:"Source *"}),(0,s.jsx)(i.p,{id:"source",name:"source",value:w.source,onChange:J,placeholder:"CRM",required:!0})]})]})]})})]}),(0,s.jsxs)(u.Zp,{children:[(0,s.jsxs)(u.aR,{children:[(0,s.jsx)(u.ZB,{children:"Field Mapping"}),(0,s.jsx)(u.BT,{children:"Map fields from the incoming webhook data to lead fields."})]}),(0,s.jsx)(u.Wu,{className:"space-y-4",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Use dot notation for nested fields (e.g., contact.phoneNumber)"}),C.map((e,a)=>(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center",children:[(0,s.jsx)("div",{className:"md:col-span-1",children:(0,s.jsxs)(d.J,{children:[e.key," *"]})}),(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsx)(i.p,{value:e.value,onChange:l=>U(a,e.key,l.target.value),placeholder:`Path to ${e.key} field in webhook data`,required:!0})})]},a)),S.map((e,a)=>(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center",children:[(0,s.jsx)("div",{className:"md:col-span-1",children:(0,s.jsx)(i.p,{value:e.key,onChange:l=>$(a,l.target.value,e.value),placeholder:"Custom field name"})}),(0,s.jsxs)("div",{className:"md:col-span-2 flex gap-2",children:[(0,s.jsx)(i.p,{value:e.value,onChange:l=>$(a,e.key,l.target.value),placeholder:"Path to field in webhook data"}),(0,s.jsx)(r.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>W(a),children:"\xd7"})]})]},`custom-${a}`)),(0,s.jsx)(r.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{T([...S,{key:"",value:""}])},children:"+ Add Custom Field"})]})})]}),(0,s.jsxs)(u.Zp,{children:[(0,s.jsxs)(u.aR,{children:[(0,s.jsx)(u.ZB,{children:"Validation Rules"}),(0,s.jsx)(u.BT,{children:"Configure validation rules for incoming webhook data."})]}),(0,s.jsx)(u.Wu,{className:"space-y-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(o.S,{id:"requirePhone",checked:w.validationRules.requirePhone,onCheckedChange:e=>L("requirePhone",e)}),(0,s.jsx)(d.J,{htmlFor:"requirePhone",children:"Require phone number"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(o.S,{id:"requireName",checked:w.validationRules.requireName,onCheckedChange:e=>L("requireName",e)}),(0,s.jsx)(d.J,{htmlFor:"requireName",children:"Require name"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(o.S,{id:"requireEmail",checked:w.validationRules.requireEmail,onCheckedChange:e=>L("requireEmail",e)}),(0,s.jsx)(d.J,{htmlFor:"requireEmail",children:"Require email"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(o.S,{id:"allowDuplicatePhone",checked:w.validationRules.allowDuplicatePhone,onCheckedChange:e=>L("allowDuplicatePhone",e)}),(0,s.jsx)(d.J,{htmlFor:"allowDuplicatePhone",children:"Allow duplicate phone numbers"})]})]})})]}),(0,s.jsxs)(u.Zp,{children:[(0,s.jsxs)(u.aR,{children:[(0,s.jsx)(u.ZB,{children:"Auto-Tag Rules"}),(0,s.jsx)(u.BT,{children:"Automatically add tags to leads based on webhook data."})]}),(0,s.jsxs)(u.Wu,{className:"space-y-4",children:[_.map((e,a)=>(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-center",children:[(0,s.jsxs)("div",{className:"space-y-2 md:col-span-1",children:[(0,s.jsx)(d.J,{children:"Field"}),(0,s.jsx)(i.p,{value:e.field,onChange:e=>B(a,"field",e.target.value),placeholder:"source"})]}),(0,s.jsxs)("div",{className:"space-y-2 md:col-span-1",children:[(0,s.jsx)(d.J,{children:"Operator"}),(0,s.jsxs)("select",{value:e.operator,onChange:e=>B(a,"operator",e.target.value),className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm text-gray-900",children:[(0,s.jsx)("option",{value:"equals",children:"equals"}),(0,s.jsx)("option",{value:"contains",children:"contains"}),(0,s.jsx)("option",{value:"exists",children:"exists"})]})]}),"exists"!==e.operator&&(0,s.jsxs)("div",{className:"space-y-2 md:col-span-1",children:[(0,s.jsx)(d.J,{children:"Value"}),(0,s.jsx)(i.p,{value:e.value||"",onChange:e=>B(a,"value",e.target.value),placeholder:"website"})]}),(0,s.jsxs)("div",{className:"space-y-2 md:col-span-1",children:[(0,s.jsx)(d.J,{children:"Tag"}),(0,s.jsx)(i.p,{value:e.tag,onChange:e=>B(a,"tag",e.target.value),placeholder:"web-lead"})]}),(0,s.jsx)("div",{className:"flex items-end md:col-span-1",children:(0,s.jsx)(r.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>z(a),children:"\xd7"})})]},a)),(0,s.jsx)(r.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{A([..._,{field:"",operator:"equals",value:"",tag:""}])},children:"+ Add Tag Rule"})]})]}),(0,s.jsxs)(u.Zp,{children:[(0,s.jsxs)(u.aR,{children:[(0,s.jsx)(u.ZB,{children:"Advanced Settings"}),(0,s.jsx)(u.BT,{children:"Configure security and additional options for your webhook."})]}),(0,s.jsxs)(u.Wu,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"autoEnrollJourneyId",children:"Auto-Enroll Journey"}),(0,s.jsxs)(c.l6,{value:w.autoEnrollJourneyId?w.autoEnrollJourneyId.toString():"none",onValueChange:e=>{k(a=>({...a,autoEnrollJourneyId:"none"===e?null:parseInt(e,10)}))},children:[(0,s.jsx)(c.bq,{className:"w-full",children:(0,s.jsx)(c.yv,{placeholder:"Select a journey (optional)"})}),(0,s.jsxs)(c.gC,{children:[(0,s.jsx)(c.eb,{value:"none",children:"None - No auto-enrollment"}),v.map(e=>(0,s.jsxs)(c.eb,{value:e.id.toString(),children:[e.name," ",!e.isActive&&"(Inactive)"]},e.id))]})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"If selected, leads created from this webhook will be automatically enrolled in the specified journey."})]}),(0,s.jsxs)("div",{className:"space-y-2 pt-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)(d.J,{children:"Required Headers"}),(0,s.jsx)(r.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{E([...q,{key:"",value:""}])},children:"+ Add Header"})]}),q.map((e,a)=>(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center",children:[(0,s.jsx)("div",{className:"md:col-span-1",children:(0,s.jsx)(i.p,{value:e.key,onChange:l=>V(a,l.target.value,e.value),placeholder:"Header name (e.g., X-API-Version)"})}),(0,s.jsxs)("div",{className:"md:col-span-2 flex gap-2",children:[(0,s.jsx)(i.p,{value:e.value,onChange:l=>V(a,e.key,l.target.value),placeholder:"Required value"}),(0,s.jsx)(r.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>Z(a),children:"\xd7"})]})]},a))]})]})]}),(0,s.jsxs)(u.Zp,{children:[(0,s.jsxs)(u.aR,{children:[(0,s.jsx)(u.ZB,{children:"Conditional Rules & Actions"}),(0,s.jsx)(u.BT,{children:"Set up advanced conditional logic to automatically execute actions when specific conditions are met."})]}),(0,s.jsxs)(u.Wu,{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(o.S,{id:"enableConditionalRules",checked:P.enabled,onCheckedChange:e=>D(a=>({...a,enabled:e}))}),(0,s.jsxs)("div",{children:[(0,s.jsx)(d.J,{htmlFor:"enableConditionalRules",className:"text-base font-medium",children:"Enable Conditional Processing"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"When enabled, webhook data will be processed through conditional rules before creating leads"})]})]}),P.enabled&&(0,s.jsxs)("div",{className:"space-y-6 border-t pt-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Logic Operator"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"How condition sets should be evaluated"})]}),(0,s.jsxs)(c.l6,{value:P.logicOperator,onValueChange:e=>D(a=>({...a,logicOperator:e})),children:[(0,s.jsx)(c.bq,{className:"w-32",children:(0,s.jsx)(c.yv,{})}),(0,s.jsxs)(c.gC,{children:[(0,s.jsx)(c.eb,{value:"AND",children:"AND"}),(0,s.jsx)(c.eb,{value:"OR",children:"OR"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Condition Sets"}),(0,s.jsx)(r.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{D(e=>({...e,conditionSets:[...e.conditionSets,{name:`Condition Set ${e.conditionSets.length+1}`,conditions:[{field:"",operator:"equals",value:"",dataType:"string"}],actions:[]}]}))},children:"+ Add Condition Set"})]}),P.conditionSets.map((l,t)=>(0,s.jsxs)(u.Zp,{className:"border-2 border-dashed",children:[(0,s.jsx)(u.aR,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.p,{value:l.name,onChange:e=>Q(t,"name",e.target.value),placeholder:"Condition Set Name",className:"max-w-md"}),(0,s.jsx)(r.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>X(t),children:"Remove Set"})]})}),(0,s.jsxs)(u.Wu,{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("h5",{className:"text-sm font-medium",children:"Conditions"}),j.length>0&&(0,s.jsxs)("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full",children:[j.length," fields available"]}),a&&e&&(0,s.jsx)(r.$,{type:"button",variant:"ghost",size:"sm",onClick:F,className:"text-xs px-2 py-1 h-6",title:"Refresh available fields from recent webhook events",children:"↻"})]}),(0,s.jsx)(r.$,{type:"button",variant:"outline",size:"sm",onClick:()=>K(t),children:"+ Add Condition"})]}),j.length>0&&(0,s.jsx)("div",{className:"mb-3 p-2 bg-blue-50 border border-blue-200 rounded-lg",children:(0,s.jsx)("p",{className:"text-xs text-blue-700",children:"\uD83D\uDCA1 Field names are populated from recent webhook data. Select from dropdown or enter custom field names."})}),l.conditions.map((e,a)=>(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-2 items-center mb-2 p-3 bg-gray-50 rounded-lg",children:[(0,s.jsx)("div",{className:"col-span-3",children:j.length>0?(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)(c.l6,{value:j.includes(e.field)?e.field:"__manual__",onValueChange:e=>{"__manual__"===e?ee(t,a,"field",""):ee(t,a,"field",e)},children:[(0,s.jsx)(c.bq,{children:(0,s.jsx)(c.yv,{placeholder:"Select field from webhook data"})}),(0,s.jsxs)(c.gC,{className:"max-h-48 overflow-y-auto",children:[(0,s.jsx)(c.eb,{value:"__manual__",children:(0,s.jsx)("span",{className:"text-gray-500",children:"Manual entry..."})}),j.map(e=>(0,s.jsx)(c.eb,{value:e,children:(0,s.jsx)("code",{className:"text-xs bg-gray-100 px-1 rounded",children:e})},e))]})]}),!j.includes(e.field)&&(0,s.jsx)(i.p,{placeholder:"Enter custom field name",value:e.field,onChange:e=>ee(t,a,"field",e.target.value)})]}):(0,s.jsx)(i.p,{placeholder:"Field (e.g., budget)",value:e.field,onChange:e=>ee(t,a,"field",e.target.value)})}),(0,s.jsx)("div",{className:"col-span-2",children:(0,s.jsxs)(c.l6,{value:e.dataType,onValueChange:e=>ee(t,a,"dataType",e),children:[(0,s.jsx)(c.bq,{children:(0,s.jsx)(c.yv,{})}),(0,s.jsxs)(c.gC,{children:[(0,s.jsx)(c.eb,{value:"string",children:"String"}),(0,s.jsx)(c.eb,{value:"number",children:"Number"}),(0,s.jsx)(c.eb,{value:"boolean",children:"Boolean"}),(0,s.jsx)(c.eb,{value:"date",children:"Date"}),(0,s.jsx)(c.eb,{value:"array",children:"Array"})]})]})}),(0,s.jsx)("div",{className:"col-span-2",children:(0,s.jsxs)(c.l6,{value:e.operator,onValueChange:e=>ee(t,a,"operator",e),children:[(0,s.jsx)(c.bq,{children:(0,s.jsx)(c.yv,{})}),(0,s.jsx)(c.gC,{children:I.filter(a=>a.dataTypes.includes(e.dataType)).map(e=>(0,s.jsx)(c.eb,{value:e.value,children:e.label},e.value))})]})}),(0,s.jsx)("div",{className:"col-span-4",children:["exists","not_exists","is_empty","is_not_empty"].includes(e.operator)?(0,s.jsx)("div",{className:"text-sm text-gray-500 italic",children:"No value required"}):(0,s.jsx)(i.p,{placeholder:"Value",value:e.value,onChange:l=>{let s=l.target.value;"number"===e.dataType?s=""===s?"":Number(s):"boolean"===e.dataType&&(s="true"===s),ee(t,a,"value",s)}})}),(0,s.jsx)("div",{className:"col-span-1",children:(0,s.jsx)(r.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>Y(t,a),children:"\xd7"})})]},a))]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("h5",{className:"text-sm font-medium",children:"Actions"}),(0,s.jsx)(r.$,{type:"button",variant:"outline",size:"sm",onClick:()=>ea(t),children:"+ Add Action"})]}),l.actions.map((e,a)=>(0,s.jsxs)("div",{className:`border rounded-lg p-4 space-y-3 ${"delete_lead"===e.type?"bg-red-50 border-red-200":"bg-blue-50"}`,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(c.l6,{value:e.type,onValueChange:e=>es(t,a,"type",e),children:[(0,s.jsx)(c.bq,{className:"max-w-xs",children:(0,s.jsx)(c.yv,{})}),(0,s.jsx)(c.gC,{children:M.map(e=>(0,s.jsx)(c.eb,{value:e.value,children:e.label},e.value))})]}),(0,s.jsx)(r.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>el(t,a),children:"Remove Action"})]}),"delete_lead"===e.type&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 p-2 bg-red-100 border border-red-300 rounded",children:[(0,s.jsx)("span",{className:"text-red-600 font-bold",children:"⚠️"}),(0,s.jsx)("span",{className:"text-xs text-red-700 font-medium",children:"WARNING: This action will permanently delete leads from your system. Use with caution."})]}),(0,s.jsx)("div",{className:`text-xs ${"delete_lead"===e.type?"text-red-600":"text-gray-600"}`,children:M.find(a=>a.value===e.type)?.description}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:et(e.type).map(l=>(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(d.J,{className:"text-xs",children:l.label}),"select"===l.type?(0,s.jsxs)(c.l6,{value:e.config[l.key]||"",onValueChange:s=>{es(t,a,"config",{...e.config,[l.key]:s})},children:[(0,s.jsx)(c.bq,{children:(0,s.jsx)(c.yv,{placeholder:`Select ${l.label}`})}),(0,s.jsx)(c.gC,{children:l.options?.map(e=>s.jsx(c.eb,{value:e.value.toString(),children:e.label},e.value))})]}):"textarea"===l.type?(0,s.jsx)("textarea",{className:"w-full p-2 text-xs border rounded resize-none",rows:2,placeholder:l.placeholder,value:e.config[l.key]||"",onChange:s=>{es(t,a,"config",{...e.config,[l.key]:s.target.value})}}):(0,s.jsx)(i.p,{className:"text-xs",placeholder:l.placeholder,value:e.config[l.key]||"",onChange:s=>{es(t,a,"config",{...e.config,[l.key]:s.target.value})}})]},l.key))})]},a))]})]})]},t)),0===P.conditionSets.length&&(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)("p",{children:"No condition sets configured"}),(0,s.jsx)("p",{className:"text-sm",children:"Add a condition set to start creating conditional rules"})]})]})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,s.jsx)(r.$,{type:"button",variant:"outline",onClick:()=>h.push("/webhooks"),disabled:f,children:"Cancel"}),(0,s.jsx)(r.$,{type:"submit",disabled:f,children:f?"Saving...":a?"Update Webhook":"Create Webhook"})]})]})}},59010:(e,a,l)=>{l.d(a,{S:()=>d});var s=l(45512),t=l(58009),n=l(2112),r=l(24849),i=l(89808);let d=t.forwardRef(({className:e,...a},l)=>(0,s.jsx)(n.bL,{ref:l,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...a,children:(0,s.jsx)(n.C1,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(r.A,{className:"h-4 w-4"})})}));d.displayName=n.bL.displayName},63451:(e,a,l)=>{l.d(a,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>r,aR:()=>i,wL:()=>u});var s=l(45512),t=l(58009),n=l(89808);let r=t.forwardRef(({className:e,...a},l)=>(0,s.jsx)("div",{ref:l,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...a}));r.displayName="Card";let i=t.forwardRef(({className:e,...a},l)=>(0,s.jsx)("div",{ref:l,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...a}));i.displayName="CardHeader";let d=t.forwardRef(({className:e,...a},l)=>(0,s.jsx)("h3",{ref:l,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",e),...a}));d.displayName="CardTitle";let o=t.forwardRef(({className:e,...a},l)=>(0,s.jsx)("p",{ref:l,className:(0,n.cn)("text-sm text-muted-foreground",e),...a}));o.displayName="CardDescription";let c=t.forwardRef(({className:e,...a},l)=>(0,s.jsx)("div",{ref:l,className:(0,n.cn)("p-6 pt-0",e),...a}));c.displayName="CardContent";let u=t.forwardRef(({className:e,...a},l)=>(0,s.jsx)("div",{ref:l,className:(0,n.cn)("flex items-center p-6 pt-0",e),...a}));u.displayName="CardFooter"},75749:(e,a,l)=>{l.d(a,{bq:()=>p,eb:()=>b,gC:()=>x,l6:()=>c,yv:()=>u});var s=l(45512),t=l(58009),n=l(81477),r=l(98755),i=l(28638),d=l(24849),o=l(7702);let c=n.bL;n.YJ;let u=n.WT,p=t.forwardRef(({className:e,children:a,...l},t)=>(0,s.jsxs)(n.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...l,children:[a,(0,s.jsx)(n.In,{asChild:!0,children:(0,s.jsx)(r.A,{className:"h-4 w-4 opacity-50"})})]}));p.displayName=n.l9.displayName;let m=t.forwardRef(({className:e,...a},l)=>(0,s.jsx)(n.PP,{ref:l,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:(0,s.jsx)(i.A,{className:"h-4 w-4"})}));m.displayName=n.PP.displayName;let h=t.forwardRef(({className:e,...a},l)=>(0,s.jsx)(n.wn,{ref:l,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:(0,s.jsx)(r.A,{className:"h-4 w-4"})}));h.displayName=n.wn.displayName;let x=t.forwardRef(({className:e,children:a,position:l="popper",...t},r)=>(0,s.jsx)(n.ZL,{children:(0,s.jsxs)(n.UC,{ref:r,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-white text-gray-800 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:l,...t,children:[(0,s.jsx)(m,{}),(0,s.jsx)(n.LM,{className:(0,o.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,s.jsx)(h,{})]})}));x.displayName=n.UC.displayName,t.forwardRef(({className:e,...a},l)=>(0,s.jsx)(n.JU,{ref:l,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...a})).displayName=n.JU.displayName;let b=t.forwardRef(({className:e,children:a,...l},t)=>(0,s.jsxs)(n.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none hover:bg-gray-50 focus:bg-gray-100 focus:text-gray-900 data-[state=checked]:bg-gray-100 data-[state=checked]:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.VF,{children:(0,s.jsx)(d.A,{className:"h-4 w-4"})})}),(0,s.jsx)(n.p4,{children:a})]}));b.displayName=n.q7.displayName,t.forwardRef(({className:e,...a},l)=>(0,s.jsx)(n.wv,{ref:l,className:(0,o.cn)("-mx-1 my-1 h-px bg-gray-200",e),...a})).displayName=n.wv.displayName},89808:(e,a,l)=>{l.d(a,{cn:()=>n});var s=l(82281),t=l(94805);function n(...e){return(0,t.QP)((0,s.$)(e))}},98060:(e,a,l)=>{l.d(a,{C:()=>r});var s=l(58009),t=l(29952),n=l(49397),r=e=>{let{present:a,children:l}=e,r=function(e){var a,l;let[t,r]=s.useState(),d=s.useRef(null),o=s.useRef(e),c=s.useRef("none"),[u,p]=(a=e?"mounted":"unmounted",l={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},s.useReducer((e,a)=>l[e][a]??e,a));return s.useEffect(()=>{let e=i(d.current);c.current="mounted"===u?e:"none"},[u]),(0,n.N)(()=>{let a=d.current,l=o.current;if(l!==e){let s=c.current,t=i(a);e?p("MOUNT"):"none"===t||a?.display==="none"?p("UNMOUNT"):l&&s!==t?p("ANIMATION_OUT"):p("UNMOUNT"),o.current=e}},[e,p]),(0,n.N)(()=>{if(t){let e;let a=t.ownerDocument.defaultView??window,l=l=>{let s=i(d.current).includes(l.animationName);if(l.target===t&&s&&(p("ANIMATION_END"),!o.current)){let l=t.style.animationFillMode;t.style.animationFillMode="forwards",e=a.setTimeout(()=>{"forwards"===t.style.animationFillMode&&(t.style.animationFillMode=l)})}},s=e=>{e.target===t&&(c.current=i(d.current))};return t.addEventListener("animationstart",s),t.addEventListener("animationcancel",l),t.addEventListener("animationend",l),()=>{a.clearTimeout(e),t.removeEventListener("animationstart",s),t.removeEventListener("animationcancel",l),t.removeEventListener("animationend",l)}}p("ANIMATION_END")},[t,p]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:s.useCallback(e=>{d.current=e?getComputedStyle(e):null,r(e)},[])}}(a),d="function"==typeof l?l({present:r.isPresent}):s.Children.only(l),o=(0,t.s)(r.ref,function(e){let a=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,l=a&&"isReactWarning"in a&&a.isReactWarning;return l?e.ref:(l=(a=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.props.ref:e.props.ref||e.ref}(d));return"function"==typeof l||r.isPresent?s.cloneElement(d,{ref:o}):null};function i(e){return e?.animationName||"none"}r.displayName="Presence"}};